{
  "version": 3,
  "sources": ["../src/app/github/ui.ts", "../src/app/ui.ts"],
  "sourcesContent": ["import type { PluginToUi, UiToPlugin, GithubScope } from '../messages';\n\ntype FolderListEntry = { type: 'dir' | 'file'; name: string; path?: string };\n\ntype GithubUiDependencies = {\n  postToPlugin(message: UiToPlugin): void;\n  log(message: string): void;\n  getLogElement(): HTMLElement | null;\n  getCollectionSelect(): HTMLSelectElement | null;\n  getModeSelect(): HTMLSelectElement | null;\n  getAllowHexCheckbox(): HTMLInputElement | null;\n  getStyleDictionaryCheckbox(): HTMLInputElement | null;\n  getFlatTokensCheckbox(): HTMLInputElement | null;\n  getImportContexts(): string[];\n};\n\ntype AttachContext = {\n  document: Document;\n  window: Window;\n};\n\ntype GithubUiApi = {\n  attach(context: AttachContext): void;\n  handleMessage(message: PluginToUi): boolean;\n  onSelectionChange(): void;\n};\n\nconst GH_REMEMBER_PREF_KEY = 'ghRememberPref';\nconst GH_MASK = '\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022';\nconst BRANCH_TTL_MS = 60_000;\n\nexport function createGithubUi(deps: GithubUiDependencies): GithubUiApi {\n  let doc: Document | null = null;\n  let win: Window | null = null;\n\n  let ghTokenInput: HTMLInputElement | null = null;\n  let ghRememberChk: HTMLInputElement | null = null;\n  let ghConnectBtn: HTMLButtonElement | null = null;\n  let ghVerifyBtn: HTMLButtonElement | null = null;\n  let ghRepoSelect: HTMLSelectElement | null = null;\n  let ghLogoutBtn: HTMLButtonElement | null = null;\n\n  let ghBranchSearch: HTMLInputElement | null = null;\n  let ghBranchSelect: HTMLSelectElement | null = null;\n  let ghBranchCountEl: HTMLElement | null = null;\n  let ghBranchRefreshBtn: HTMLButtonElement | null = null;\n\n  let ghNewBranchBtn: HTMLButtonElement | null = null;\n  let ghNewBranchRow: HTMLElement | null = null;\n  let ghNewBranchName: HTMLInputElement | null = null;\n  let ghCreateBranchConfirmBtn: HTMLButtonElement | null = null;\n\n  let ghFolderInput: HTMLInputElement | null = null;\n  let ghPickFolderBtn: HTMLButtonElement | null = null;\n  let ghCommitMsgInput: HTMLInputElement | null = null;\n  let ghExportAndCommitBtn: HTMLButtonElement | null = null;\n  let ghCreatePrChk: HTMLInputElement | null = null;\n  let ghPrOptionsEl: HTMLElement | null = null;\n  let ghPrTitleInput: HTMLInputElement | null = null;\n  let ghPrBodyInput: HTMLTextAreaElement | null = null;\n  let ghFetchPathInput: HTMLInputElement | null = null;\n  let ghFetchTokensBtn: HTMLButtonElement | null = null;\n  let ghScopeSelected: HTMLInputElement | null = null;\n  let ghScopeAll: HTMLInputElement | null = null;\n  let ghScopeTypography: HTMLInputElement | null = null;\n  let styleDictionaryCheckbox: HTMLInputElement | null = null;\n  let flatTokensCheckbox: HTMLInputElement | null = null;\n\n  let ghAuthStatusEl: HTMLElement | null = null;\n  let ghTokenMetaEl: HTMLElement | null = null;\n\n  let folderPickerOverlay: HTMLElement | null = null;\n  let folderPickerTitleEl: HTMLElement | null = null;\n  let folderPickerPathInput: HTMLInputElement | null = null;\n  let folderPickerUseBtn: HTMLButtonElement | null = null;\n  let folderPickerListEl: HTMLElement | null = null;\n  let folderPickerNewBtn: HTMLButtonElement | null = null;\n  let folderPickerCancelBtn: HTMLButtonElement | null = null;\n\n  let folderPickerIsOpen = false;\n  let folderPickerCurrentPath = '';\n  let folderPickerLastFocus: HTMLElement | null = null;\n  let folderPickerRefreshNonce = 0;\n\n  const folderListWaiters: Array<{\n    path: string;\n    resolve: (v: { ok: true; entries: FolderListEntry[] }) => void;\n    reject: (v: { ok: false; message: string }) => void;\n  }> = [];\n\n  const folderCreateWaiters: Array<{\n    folderPath: string;\n    resolve: (v: { ok: true }) => void;\n    reject: (v: { ok: false; message: string; status?: number }) => void;\n  }> = [];\n\n  let ghIsAuthed = false;\n  let ghTokenExpiresAt: string | number | null = null;\n  let ghRememberPref = false;\n\n  let currentOwner = '';\n  let currentRepo = '';\n  let desiredBranch: string | null = null;\n  let defaultBranchFromApi: string | undefined = undefined;\n  let loadedPages = 0;\n  let hasMorePages = false;\n  let isFetchingBranches = false;\n  let lastBranchesFetchedAtMs = 0;\n\n  let allBranches: string[] = [];\n  let filteredBranches: string[] = [];\n  let renderCount = 0;\n  const RENDER_STEP = 200;\n\n  function pickCollectionSelect(): HTMLSelectElement | null {\n    return deps.getCollectionSelect();\n  }\n\n  function pickModeSelect(): HTMLSelectElement | null {\n    return deps.getModeSelect();\n  }\n\n  function pickAllowHexCheckbox(): HTMLInputElement | null {\n    return deps.getAllowHexCheckbox();\n  }\n\n  function pickStyleDictionaryCheckbox(): HTMLInputElement | null {\n    if (!styleDictionaryCheckbox) styleDictionaryCheckbox = deps.getStyleDictionaryCheckbox();\n    return styleDictionaryCheckbox;\n  }\n\n  function pickFlatTokensCheckbox(): HTMLInputElement | null {\n    if (!flatTokensCheckbox) flatTokensCheckbox = deps.getFlatTokensCheckbox();\n    return flatTokensCheckbox;\n  }\n\n  function findTokenInput(): HTMLInputElement | null {\n    if (!doc) return null;\n    return (\n      (doc.getElementById('githubTokenInput') as HTMLInputElement | null) ||\n      (doc.getElementById('ghTokenInput') as HTMLInputElement | null) ||\n      (doc.getElementById('githubPatInput') as HTMLInputElement | null) ||\n      (doc.querySelector('input[name=\"githubToken\"]') as HTMLInputElement | null) ||\n      (doc.querySelector('input[type=\"password\"]') as HTMLInputElement | null)\n    );\n  }\n\n  function readPatFromUi(): string {\n    if (!ghTokenInput) ghTokenInput = findTokenInput();\n    if (!ghTokenInput) return '';\n    if (ghTokenInput.getAttribute('data-filled') === '1') return GH_MASK;\n    return (ghTokenInput.value || '').trim();\n  }\n\n  function saveRememberPref(checked: boolean): void {\n    try { win?.localStorage.setItem(GH_REMEMBER_PREF_KEY, checked ? '1' : '0'); } catch { /* ignore */ }\n  }\n\n  function loadRememberPref(): boolean {\n    try {\n      const v = win?.localStorage.getItem(GH_REMEMBER_PREF_KEY);\n      if (v === '1') return true;\n      if (v === '0') return false;\n    } catch { /* ignore */ }\n    return false;\n  }\n\n  function ensureGhStatusElements(): void {\n    if (!doc) return;\n    if (!ghAuthStatusEl) ghAuthStatusEl = doc.getElementById('ghAuthStatus');\n    if (!ghTokenMetaEl) ghTokenMetaEl = doc.getElementById('ghTokenMeta');\n    if (!ghLogoutBtn) ghLogoutBtn = doc.getElementById('ghLogoutBtn') as HTMLButtonElement | null;\n  }\n\n  function formatTimeLeft(expInput: string | number): string {\n    const exp = typeof expInput === 'number' ? expInput : Date.parse(expInput);\n    if (!isFinite(exp)) return 'expiration: unknown';\n    const now = Date.now();\n    const ms = exp - now;\n    if (ms <= 0) return 'expired';\n    const days = Math.floor(ms / (24 * 60 * 60 * 1000));\n    const hours = Math.floor((ms % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000));\n    if (days > 0) return `${days}d ${hours}h left`;\n    const mins = Math.floor((ms % (60 * 60 * 1000)) / (60 * 1000));\n    if (hours > 0) return `${hours}h ${mins}m left`;\n    const secs = Math.floor((ms % (60 * 1000)) / 1000);\n    if (mins > 0) return `${mins}m ${secs}s left`;\n    return `${secs}s left`;\n  }\n\n  function setPatFieldObfuscated(filled: boolean): void {\n    if (!ghTokenInput) ghTokenInput = findTokenInput();\n    if (!ghTokenInput) return;\n    ghTokenInput.type = 'password';\n    if (filled) {\n      ghTokenInput.value = GH_MASK;\n      ghTokenInput.setAttribute('data-filled', '1');\n    } else {\n      ghTokenInput.value = '';\n      ghTokenInput.removeAttribute('data-filled');\n    }\n  }\n\n  function updateGhStatusUi(): void {\n    ensureGhStatusElements();\n\n    if (ghAuthStatusEl) {\n      ghAuthStatusEl.textContent = ghIsAuthed ? 'GitHub: authenticated.' : 'GitHub: not authenticated.';\n    }\n\n    if (ghTokenMetaEl) {\n      const rememberTxt = ghRememberPref ? 'Remember me: on' : 'Remember me: off';\n      const expTxt = ghTokenExpiresAt ? `Token ${formatTimeLeft(ghTokenExpiresAt)}` : 'Token expiration: unknown';\n      ghTokenMetaEl.textContent = `${expTxt} \u2022 ${rememberTxt}`;\n    }\n\n    if (ghTokenInput) {\n      ghTokenInput.oninput = () => {\n        if (ghTokenInput && ghTokenInput.getAttribute('data-filled') === '1') {\n          ghTokenInput.removeAttribute('data-filled');\n        }\n        if (ghConnectBtn) ghConnectBtn.disabled = false;\n      };\n    }\n\n    if (ghConnectBtn && ghTokenInput) {\n      const isMasked = ghTokenInput.getAttribute('data-filled') === '1';\n      ghConnectBtn.disabled = ghIsAuthed && isMasked;\n    }\n\n    if (ghLogoutBtn) {\n      ghLogoutBtn.disabled = !ghIsAuthed;\n    }\n\n    if (ghRememberChk) {\n      ghRememberChk.checked = ghRememberPref;\n    }\n  }\n\n  function setGitHubDisabledStates(): void {\n    updateGhStatusUi();\n  }\n\n  function showNewBranchRow(show: boolean): void {\n    if (!ghNewBranchRow) return;\n    ghNewBranchRow.style.display = show ? 'flex' : 'none';\n    if (show && ghNewBranchName) {\n      if (!ghNewBranchName.value) {\n        ghNewBranchName.value = `tokens/update-${new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19)}`;\n      }\n      ghNewBranchName.focus();\n      ghNewBranchName.select();\n    }\n  }\n\n  function revalidateBranchesIfStale(forceLog = false): void {\n    if (!ghRepoSelect || !ghBranchSelect) return;\n    if (!currentOwner || !currentRepo) return;\n\n    const stale = (Date.now() - lastBranchesFetchedAtMs) > BRANCH_TTL_MS;\n    if (!stale) {\n      if (forceLog) deps.log('Branches are up to date (no refresh needed).');\n      return;\n    }\n\n    desiredBranch = desiredBranch || null;\n    defaultBranchFromApi = undefined;\n    loadedPages = 0; hasMorePages = false; isFetchingBranches = true;\n    allBranches = []; filteredBranches = [];\n    renderCount = 0;\n\n    setBranchDisabled(true, 'Refreshing branches\u2026');\n    updateBranchCount();\n    deps.log('Refreshing branches\u2026');\n\n    deps.postToPlugin({\n      type: 'GITHUB_FETCH_BRANCHES',\n      payload: { owner: currentOwner, repo: currentRepo, page: 1 }\n    });\n  }\n\n  function setBranchDisabled(disabled: boolean, placeholder?: string): void {\n    if (!ghBranchSelect) return;\n    ghBranchSelect.disabled = disabled;\n    if (placeholder !== undefined) {\n      clearSelect(ghBranchSelect);\n      const opt = doc!.createElement('option');\n      opt.value = '';\n      opt.textContent = placeholder;\n      ghBranchSelect.appendChild(opt);\n    }\n  }\n\n  function updateBranchCount(): void {\n    if (!ghBranchCountEl) return;\n    const total = allBranches.length;\n    const showing = filteredBranches.length;\n    ghBranchCountEl.textContent = `${showing} / ${total}${hasMorePages ? ' +' : ''}`;\n  }\n\n  function clearSelect(sel: HTMLSelectElement): void {\n    while (sel.options.length > 0) sel.remove(0);\n  }\n\n  function renderOptions(): void {\n    if (!ghBranchSelect) return;\n    const prev = ghBranchSelect.value;\n    clearSelect(ghBranchSelect);\n\n    const slice = filteredBranches.slice(0, renderCount);\n    for (const name of slice) {\n      const opt = doc!.createElement('option');\n      opt.value = name;\n      opt.textContent = name;\n      ghBranchSelect.appendChild(opt);\n    }\n\n    if (filteredBranches.length > renderCount) {\n      const opt = doc!.createElement('option');\n      opt.value = '__more__';\n      opt.textContent = `Load more\u2026 (${filteredBranches.length - renderCount} more)`;\n      ghBranchSelect.appendChild(opt);\n    } else if (hasMorePages) {\n      const opt = doc!.createElement('option');\n      opt.value = '__fetch__';\n      opt.textContent = 'Load next page\u2026';\n      ghBranchSelect.appendChild(opt);\n    }\n\n    const want = desiredBranch || defaultBranchFromApi || prev;\n    if (want && slice.includes(want)) {\n      ghBranchSelect.value = want;\n    } else if (ghBranchSelect.options.length) {\n      ghBranchSelect.selectedIndex = 0;\n    }\n  }\n\n  function applyBranchFilter(): void {\n    const q = (ghBranchSearch?.value || '').toLowerCase().trim();\n    filteredBranches = q\n      ? allBranches.filter(n => n.toLowerCase().includes(q))\n      : [...allBranches];\n\n    renderCount = Math.min(RENDER_STEP, filteredBranches.length);\n    renderOptions();\n    updateBranchCount();\n  }\n\n  function ensureNextPageIfNeeded(): void {\n    if (!ghBranchSelect || !ghRepoSelect) return;\n    if (!hasMorePages || isFetchingBranches) return;\n    if (!currentOwner || !currentRepo) return;\n\n    isFetchingBranches = true;\n    deps.postToPlugin({\n      type: 'GITHUB_FETCH_BRANCHES',\n      payload: { owner: currentOwner, repo: currentRepo, page: loadedPages + 1 }\n    });\n  }\n\n  function onBranchScroll(): void {\n    if (!ghBranchSelect) return;\n    const el = ghBranchSelect;\n    const nearBottom = el.scrollTop + el.clientHeight >= el.scrollHeight - 24;\n    if (nearBottom && filteredBranches.length === allBranches.length && hasMorePages && !isFetchingBranches) {\n      ensureNextPageIfNeeded();\n    }\n  }\n\n  function onBranchChange(): void {\n    if (!ghBranchSelect) return;\n    const v = ghBranchSelect.value;\n    if (v === '__more__') {\n      renderCount = Math.min(renderCount + RENDER_STEP, filteredBranches.length);\n      renderOptions();\n      return;\n    }\n    if (v === '__fetch__') {\n      ensureNextPageIfNeeded();\n      return;\n    }\n    if (!v) return;\n\n    desiredBranch = v;\n    deps.postToPlugin({\n      type: 'GITHUB_SELECT_BRANCH',\n      payload: { owner: currentOwner, repo: currentRepo, branch: v }\n    });\n\n    updateFolderControlsEnabled();\n    updateExportCommitEnabled();\n    updateFetchButtonEnabled();\n  }\n\n  function normalizeFolderInput(raw: string): { display: string; payload: string } {\n    const trimmed = raw.trim();\n    if (!trimmed) return { display: '', payload: '' };\n\n    if (trimmed === '/' || trimmed === './' || trimmed === '.') {\n      return { display: '/', payload: '/' };\n    }\n\n    const collapsed = trimmed.replace(/\\\\/g, '/').replace(/\\/{2,}/g, '/');\n    const stripped = collapsed.replace(/^\\/+/, '').replace(/\\/+$/, '');\n    if (!stripped) return { display: '/', payload: '/' };\n    return { display: stripped + '/', payload: stripped };\n  }\n\n  function normalizeFolderPickerPath(raw: string): string {\n    const trimmed = (raw || '').trim();\n    if (!trimmed || trimmed === '/' || trimmed === './' || trimmed === '.') return '';\n    const collapsed = trimmed.replace(/\\\\/g, '/').replace(/\\/{2,}/g, '/');\n    return collapsed.replace(/^\\/+/, '').replace(/\\/+$/, '');\n  }\n\n  function listDir(path: string): Promise<{ ok: true; entries: FolderListEntry[] } | { ok: false; message: string }> {\n    return new Promise(resolve => {\n      const req = { path: path.replace(/^\\/+|\\/+$/g, '') };\n      folderListWaiters.push({\n        path: req.path,\n        resolve: v => resolve(v),\n        reject: v => resolve(v)\n      });\n      deps.postToPlugin({\n        type: 'GITHUB_FOLDER_LIST',\n        payload: { owner: currentOwner, repo: currentRepo, branch: getCurrentBranch(), path: req.path }\n      });\n    });\n  }\n\n  function ensureFolder(folderPath: string): Promise<{ ok: true } | { ok: false; message: string; status?: number }> {\n    return new Promise(resolve => {\n      const fp = folderPath.replace(/^\\/+|\\/+$/g, '');\n      folderCreateWaiters.push({\n        folderPath: fp,\n        resolve: v => resolve(v),\n        reject: v => resolve(v)\n      });\n      deps.postToPlugin({\n        type: 'GITHUB_CREATE_FOLDER',\n        payload: { owner: currentOwner, repo: currentRepo, branch: getCurrentBranch(), folderPath: fp }\n      });\n    });\n  }\n\n  function openFolderPicker(): void {\n    if (!currentOwner || !currentRepo) { deps.log('Pick a repository first.'); return; }\n    const ref = getCurrentBranch();\n    if (!ref) { deps.log('Pick a branch first.'); return; }\n    if (!(folderPickerOverlay && folderPickerTitleEl && folderPickerPathInput && folderPickerListEl)) {\n      deps.log('Folder picker UI is unavailable.');\n      return;\n    }\n\n    folderPickerLastFocus = (doc && doc.activeElement instanceof HTMLElement) ? doc.activeElement : null;\n\n    folderPickerOverlay.hidden = false;\n    folderPickerOverlay.classList.add('is-open');\n    folderPickerOverlay.setAttribute('aria-hidden', 'false');\n    folderPickerIsOpen = true;\n\n    updateFolderPickerTitle(ref);\n\n    const startNormalized = normalizeFolderInput(ghFolderInput?.value || '');\n    const startPath = startNormalized.payload === '/' ? '' : startNormalized.payload;\n    setFolderPickerPath(startPath, true);\n\n    win?.setTimeout(() => {\n      folderPickerPathInput?.focus();\n      folderPickerPathInput?.select();\n    }, 0);\n  }\n\n  function closeFolderPicker(): void {\n    if (!folderPickerOverlay) return;\n    folderPickerOverlay.classList.remove('is-open');\n    folderPickerOverlay.setAttribute('aria-hidden', 'true');\n    folderPickerOverlay.hidden = true;\n    folderPickerIsOpen = false;\n    folderPickerCurrentPath = '';\n    folderPickerRefreshNonce++;\n    if (folderPickerListEl) {\n      folderPickerListEl.replaceChildren(createFolderPickerRow('Loading\u2026', { muted: true, disabled: true }));\n    }\n    if (folderPickerLastFocus && doc?.contains(folderPickerLastFocus)) {\n      folderPickerLastFocus.focus();\n    }\n    folderPickerLastFocus = null;\n  }\n\n  function createFolderPickerRow(label: string, options?: {\n    onClick?: () => void;\n    muted?: boolean;\n    disabled?: boolean;\n  }): HTMLButtonElement {\n    if (!doc) throw new Error('GitHub UI not attached');\n    const btn = doc.createElement('button');\n    btn.type = 'button';\n    btn.className = 'folder-picker-row';\n    btn.textContent = label;\n    if (options?.muted) btn.classList.add('is-muted');\n    if (options?.disabled) btn.disabled = true;\n    if (options?.onClick) {\n      btn.addEventListener('click', event => {\n        event.preventDefault();\n        options.onClick?.();\n      });\n    }\n    return btn;\n  }\n\n  function updateFolderPickerTitle(branch: string): void {\n    if (!folderPickerTitleEl) return;\n    if (currentOwner && currentRepo) {\n      folderPickerTitleEl.textContent = `${currentOwner}/${currentRepo} @ ${branch}`;\n    } else {\n      folderPickerTitleEl.textContent = 'Select a repository first';\n    }\n  }\n\n  function setFolderPickerPath(raw: string, refresh = true): void {\n    const normalized = normalizeFolderPickerPath(raw);\n    folderPickerCurrentPath = normalized;\n    if (folderPickerPathInput) folderPickerPathInput.value = normalized;\n    if (refresh && folderPickerIsOpen) {\n      void refreshFolderPickerList();\n    }\n  }\n\n  async function refreshFolderPickerList(): Promise<void> {\n    if (!(folderPickerListEl && folderPickerIsOpen)) return;\n    const listEl = folderPickerListEl;\n    const requestId = ++folderPickerRefreshNonce;\n\n    listEl.replaceChildren(createFolderPickerRow('Loading\u2026', { muted: true, disabled: true }));\n\n    const path = folderPickerCurrentPath;\n    const res = await listDir(path);\n    if (requestId !== folderPickerRefreshNonce) return;\n\n    if (!('ok' in res) || !res.ok) {\n      const message = 'message' in res && res.message ? res.message : 'failed to fetch';\n      listEl.replaceChildren(createFolderPickerRow(`Error: ${message}`, { muted: true, disabled: true }));\n      return;\n    }\n\n    const nodes: HTMLElement[] = [];\n    if (path) {\n      nodes.push(createFolderPickerRow('.. (up one level)', {\n        muted: true,\n        onClick: () => {\n          const parentParts = folderPickerCurrentPath.split('/').filter(Boolean);\n          parentParts.pop();\n          setFolderPickerPath(parentParts.join('/'));\n        }\n      }));\n    }\n\n    const entries = Array.isArray(res.entries) ? res.entries : [];\n    const dirs = entries.filter(e => e.type === 'dir').sort((a, b) => (a.name || '').localeCompare(b.name || ''));\n    if (dirs.length === 0) {\n      nodes.push(createFolderPickerRow('(no subfolders)', { muted: true, disabled: true }));\n    } else {\n      for (const d of dirs) {\n        const name = d.name || '';\n        nodes.push(createFolderPickerRow(`${name}/`, {\n          onClick: () => {\n            const next = folderPickerCurrentPath ? `${folderPickerCurrentPath}/${name}` : name;\n            setFolderPickerPath(next);\n          }\n        }));\n      }\n    }\n\n    listEl.replaceChildren(...nodes);\n  }\n\n  function handleFolderPickerKeydown(event: KeyboardEvent): void {\n    if (!folderPickerIsOpen) return;\n    if (event.key === 'Escape') {\n      event.preventDefault();\n      closeFolderPicker();\n    }\n  }\n\n  function populateGhRepos(list: Array<{ full_name: string; default_branch: string; private: boolean }>): void {\n    if (!ghRepoSelect) return;\n    while (ghRepoSelect.options.length) ghRepoSelect.remove(0);\n    for (const r of list) {\n      const opt = doc!.createElement('option');\n      opt.value = r.full_name;\n      opt.textContent = r.full_name;\n      ghRepoSelect.appendChild(opt);\n    }\n    ghRepoSelect.disabled = list.length === 0;\n\n    if (list.length > 0) {\n      if (currentOwner && currentRepo) {\n        const want = `${currentOwner}/${currentRepo}`;\n        let matched = false;\n        for (let i = 0; i < ghRepoSelect.options.length; i++) {\n          if (ghRepoSelect.options[i].value === want) {\n            ghRepoSelect.selectedIndex = i;\n            matched = true;\n            break;\n          }\n        }\n        if (matched) {\n          ghRepoSelect.dispatchEvent(new Event('change', { bubbles: true }));\n        }\n      } else {\n        ghRepoSelect.selectedIndex = 0;\n        ghRepoSelect.dispatchEvent(new Event('change', { bubbles: true }));\n      }\n    }\n  }\n\n  function getCurrentBranch(): string {\n    const v = (ghBranchSelect && !ghBranchSelect.disabled &&\n      ghBranchSelect.value && ghBranchSelect.value !== '__more__' && ghBranchSelect.value !== '__fetch__')\n      ? ghBranchSelect.value\n      : (desiredBranch || defaultBranchFromApi || '');\n    return v || '';\n  }\n\n  function getPrBaseBranch(): string {\n    return defaultBranchFromApi || '';\n  }\n\n  function persistGhState(partial: Partial<{\n    owner: string;\n    repo: string;\n    branch: string;\n    folder: string;\n    commitMessage: string;\n    scope: GithubScope;\n    collection: string;\n    mode: string;\n    styleDictionary: boolean;\n    flatTokens: boolean;\n    createPr: boolean;\n    prBase: string;\n    prTitle: string;\n    prBody: string;\n  }>): void {\n    deps.postToPlugin({ type: 'GITHUB_SAVE_STATE', payload: partial });\n  }\n\n  function updateExportCommitEnabled(): void {\n    const collectionSelect = pickCollectionSelect();\n    const modeSelect = pickModeSelect();\n\n    const hasRepo = !!(currentOwner && currentRepo);\n    const br = getCurrentBranch();\n    const commitMsg = (ghCommitMsgInput?.value || '').trim();\n    const scopeAll = !!(ghScopeAll && ghScopeAll.checked);\n    const scopeTypography = !!(ghScopeTypography && ghScopeTypography.checked);\n    const folderRaw = ghFolderInput ? ghFolderInput.value.trim() : '';\n    const hasFolder = normalizeFolderInput(folderRaw).display.length > 0;\n\n    const hasSelection = (scopeAll || scopeTypography)\n      ? true\n      : !!(collectionSelect && collectionSelect.value && modeSelect && modeSelect.value);\n\n    let ready = !!(ghIsAuthed && hasRepo && br && commitMsg && hasSelection && hasFolder);\n\n    if (ghCreatePrChk && ghCreatePrChk.checked) {\n      const prBase = getPrBaseBranch();\n      if (!prBase || prBase === br) {\n        ready = false;\n      }\n    }\n\n    if (ghExportAndCommitBtn) ghExportAndCommitBtn.disabled = !ready;\n  }\n\n  function updateFolderControlsEnabled(): void {\n    const br = getCurrentBranch();\n    const enable = !!(currentOwner && currentRepo && br);\n    if (ghPickFolderBtn) ghPickFolderBtn.disabled = !enable;\n    updateExportCommitEnabled();\n    updateFetchButtonEnabled();\n  }\n\n  function updateFetchButtonEnabled(): void {\n    const hasRepo = !!(ghIsAuthed && currentOwner && currentRepo);\n    const branch = getCurrentBranch();\n    const path = (ghFetchPathInput?.value || '').trim();\n    if (ghFetchTokensBtn) ghFetchTokensBtn.disabled = !(hasRepo && branch && path);\n  }\n\n  function attach(context: AttachContext): void {\n    doc = context.document;\n    win = context.window;\n\n    ghTokenInput = findTokenInput();\n    ghRememberChk = (doc.getElementById('githubRememberChk') as HTMLInputElement | null)\n      || (doc.getElementById('ghRememberChk') as HTMLInputElement | null);\n    ghConnectBtn = (doc.getElementById('githubConnectBtn') as HTMLButtonElement | null)\n      || (doc.getElementById('ghConnectBtn') as HTMLButtonElement | null);\n    ghVerifyBtn = (doc.getElementById('githubVerifyBtn') as HTMLButtonElement | null)\n      || (doc.getElementById('ghVerifyBtn') as HTMLButtonElement | null);\n    ghLogoutBtn = doc.getElementById('ghLogoutBtn') as HTMLButtonElement | null;\n    ghRepoSelect = doc.getElementById('ghRepoSelect') as HTMLSelectElement | null;\n\n    ghBranchSearch = doc.getElementById('ghBranchSearch') as HTMLInputElement | null;\n    ghBranchSelect = doc.getElementById('ghBranchSelect') as HTMLSelectElement | null;\n    ghBranchCountEl = doc.getElementById('ghBranchCount');\n    ghBranchRefreshBtn = doc.getElementById('ghBranchRefreshBtn') as HTMLButtonElement | null;\n\n    ghNewBranchBtn = doc.getElementById('ghNewBranchBtn') as HTMLButtonElement | null;\n    ghNewBranchRow = doc.getElementById('ghNewBranchRow');\n    ghNewBranchName = doc.getElementById('ghNewBranchName') as HTMLInputElement | null;\n    ghCreateBranchConfirmBtn = doc.getElementById('ghCreateBranchConfirmBtn') as HTMLButtonElement | null;\n\n    ghFolderInput = doc.getElementById('ghFolderInput') as HTMLInputElement | null;\n    ghPickFolderBtn = doc.getElementById('ghPickFolderBtn') as HTMLButtonElement | null;\n    ghCommitMsgInput = doc.getElementById('ghCommitMsgInput') as HTMLInputElement | null;\n    ghExportAndCommitBtn = doc.getElementById('ghExportAndCommitBtn') as HTMLButtonElement | null;\n    ghCreatePrChk = doc.getElementById('ghCreatePrChk') as HTMLInputElement | null;\n    ghPrOptionsEl = doc.getElementById('ghPrOptions');\n    ghPrTitleInput = doc.getElementById('ghPrTitleInput') as HTMLInputElement | null;\n    ghPrBodyInput = doc.getElementById('ghPrBodyInput') as HTMLTextAreaElement | null;\n    ghFetchPathInput = doc.getElementById('ghFetchPathInput') as HTMLInputElement | null;\n    ghFetchTokensBtn = doc.getElementById('ghFetchTokensBtn') as HTMLButtonElement | null;\n    ghScopeSelected = doc.getElementById('ghScopeSelected') as HTMLInputElement | null;\n    ghScopeAll = doc.getElementById('ghScopeAll') as HTMLInputElement | null;\n    ghScopeTypography = doc.getElementById('ghScopeTypography') as HTMLInputElement | null;\n\n    folderPickerOverlay = doc.getElementById('folderPickerOverlay');\n    folderPickerTitleEl = doc.getElementById('folderPickerTitle');\n    folderPickerPathInput = doc.getElementById('folderPickerPath') as HTMLInputElement | null;\n    folderPickerUseBtn = doc.getElementById('folderPickerUseBtn') as HTMLButtonElement | null;\n    folderPickerListEl = doc.getElementById('folderPickerList');\n    folderPickerNewBtn = doc.getElementById('folderPickerNewBtn') as HTMLButtonElement | null;\n    folderPickerCancelBtn = doc.getElementById('folderPickerCancelBtn') as HTMLButtonElement | null;\n\n    ghRememberPref = loadRememberPref();\n    if (ghRememberChk) {\n      ghRememberChk.checked = ghRememberPref;\n      ghRememberChk.addEventListener('change', () => {\n        ghRememberPref = !!ghRememberChk!.checked;\n        saveRememberPref(ghRememberPref);\n        updateGhStatusUi();\n      });\n    }\n\n    ensureGhStatusElements();\n\n    if (ghConnectBtn) ghConnectBtn.addEventListener('click', onGitHubConnectClick);\n    if (ghVerifyBtn) ghVerifyBtn.addEventListener('click', onGitHubVerifyClick);\n    if (ghLogoutBtn) ghLogoutBtn.addEventListener('click', onGitHubLogoutClick);\n\n    if (ghRepoSelect && ghBranchSelect) {\n      let lastRepoKey = '';\n      ghRepoSelect.addEventListener('change', () => {\n        const value = ghRepoSelect!.value;\n        if (!value) return;\n        if (value === lastRepoKey) return;\n        lastRepoKey = value;\n\n        const parts = value.split('/');\n        currentOwner = parts[0] || '';\n        currentRepo = parts[1] || '';\n\n        updateExportCommitEnabled();\n        updateFetchButtonEnabled();\n\n        lastBranchesFetchedAtMs = 0;\n\n        deps.postToPlugin({ type: 'GITHUB_SELECT_REPO', payload: { owner: currentOwner, repo: currentRepo } });\n\n        desiredBranch = null;\n        defaultBranchFromApi = undefined;\n        loadedPages = 0; hasMorePages = false; isFetchingBranches = false;\n        allBranches = []; filteredBranches = [];\n        renderCount = 0;\n        if (ghBranchSearch) ghBranchSearch.value = '';\n\n        setBranchDisabled(true, 'Loading branches\u2026');\n        updateBranchCount();\n        updateFolderControlsEnabled();\n\n        if (ghFolderInput) ghFolderInput.value = '';\n\n        if (currentOwner && currentRepo) {\n          deps.log(`GitHub: loading branches for ${currentOwner}/${currentRepo}\u2026`);\n          isFetchingBranches = true;\n          deps.postToPlugin({\n            type: 'GITHUB_FETCH_BRANCHES',\n            payload: { owner: currentOwner, repo: currentRepo, page: 1 }\n          });\n        }\n\n        updateExportCommitEnabled();\n      });\n    }\n\n    if (ghBranchSearch) {\n      let timeout: number | undefined;\n      ghBranchSearch.addEventListener('input', () => {\n        if (timeout) win?.clearTimeout(timeout);\n        timeout = win?.setTimeout(() => {\n          applyBranchFilter();\n        }, 120) as number | undefined;\n      });\n      ghBranchSearch.addEventListener('keydown', (e: KeyboardEvent) => {\n        if (e.key === 'Enter') revalidateBranchesIfStale(true);\n      });\n    }\n\n    if (ghBranchSelect) {\n      ghBranchSelect.addEventListener('change', onBranchChange);\n      ghBranchSelect.addEventListener('scroll', onBranchScroll);\n    }\n\n    if (ghBranchRefreshBtn) {\n      ghBranchRefreshBtn.addEventListener('click', () => {\n        lastBranchesFetchedAtMs = 0;\n        revalidateBranchesIfStale(true);\n      });\n    }\n\n    if (ghPickFolderBtn) {\n      ghPickFolderBtn.addEventListener('click', openFolderPicker);\n    }\n\n    if (folderPickerOverlay) {\n      folderPickerOverlay.addEventListener('click', event => {\n        if (event.target === folderPickerOverlay) closeFolderPicker();\n      });\n    }\n\n    if (folderPickerCancelBtn) {\n      folderPickerCancelBtn.addEventListener('click', () => closeFolderPicker());\n    }\n\n    if (folderPickerPathInput) {\n      folderPickerPathInput.addEventListener('keydown', event => {\n        if (event.key === 'Enter') {\n          event.preventDefault();\n          setFolderPickerPath(folderPickerPathInput!.value);\n        }\n      });\n      folderPickerPathInput.addEventListener('blur', () => {\n        setFolderPickerPath(folderPickerPathInput!.value);\n      });\n    }\n\n    if (folderPickerUseBtn) {\n      folderPickerUseBtn.addEventListener('click', () => {\n        const selectionRaw = folderPickerCurrentPath ? `${folderPickerCurrentPath}/` : '/';\n        const normalized = normalizeFolderInput(selectionRaw);\n        if (ghFolderInput) ghFolderInput.value = normalized.display;\n        deps.postToPlugin({\n          type: 'GITHUB_SET_FOLDER',\n          payload: { owner: currentOwner, repo: currentRepo, folder: normalized.payload }\n        });\n        persistGhState({ folder: normalized.payload });\n        closeFolderPicker();\n        deps.log(`Folder selected: ${normalized.display === '/' ? '(repo root)' : normalized.display}`);\n        updateExportCommitEnabled();\n        updateFetchButtonEnabled();\n      });\n    }\n\n    if (folderPickerNewBtn) {\n      folderPickerNewBtn.addEventListener('click', () => {\n        const name = win?.prompt('New folder name (no spaces; use \"-\" or \"_\")', 'tokens');\n        if (!name) return;\n        const trimmed = name.trim().replace(/^\\/+/, '').replace(/\\/+$/, '');\n        if (!trimmed || /\\s/.test(trimmed) || /[~^:?*[\\]\\\\]/.test(trimmed)) {\n          win?.alert('Invalid folder name.');\n          return;\n        }\n        const next = folderPickerCurrentPath ? `${folderPickerCurrentPath}/${trimmed}` : trimmed;\n        const normalizedPath = normalizeFolderPickerPath(next);\n        const normalized = normalizeFolderInput(normalizedPath ? `${normalizedPath}/` : '/');\n        if (ghFolderInput) ghFolderInput.value = normalized.display;\n        deps.postToPlugin({\n          type: 'GITHUB_SET_FOLDER',\n          payload: { owner: currentOwner, repo: currentRepo, folder: normalized.payload }\n        });\n        persistGhState({ folder: normalized.payload });\n        closeFolderPicker();\n        deps.log(`Folder selected (will be created on export): ${normalized.display}`);\n        updateExportCommitEnabled();\n        updateFetchButtonEnabled();\n      });\n    }\n\n    if (ghFolderInput) {\n      ghFolderInput.addEventListener('input', () => {\n        updateExportCommitEnabled();\n        updateFetchButtonEnabled();\n      });\n      ghFolderInput.addEventListener('blur', () => {\n        const normalized = normalizeFolderInput(ghFolderInput!.value);\n        ghFolderInput!.value = normalized.display;\n        deps.postToPlugin({\n          type: 'GITHUB_SET_FOLDER',\n          payload: { owner: currentOwner, repo: currentRepo, folder: normalized.payload }\n        });\n        persistGhState({ folder: normalized.payload });\n        updateExportCommitEnabled();\n        updateFetchButtonEnabled();\n      });\n    }\n\n    if (ghCommitMsgInput) {\n      ghCommitMsgInput.addEventListener('input', () => {\n        updateExportCommitEnabled();\n        persistGhState({ commitMessage: ghCommitMsgInput!.value || '' });\n      });\n    }\n\n    if (ghScopeSelected) {\n      ghScopeSelected.addEventListener('change', () => {\n        if (ghScopeSelected?.checked && ghPrOptionsEl) {\n          ghPrOptionsEl.style.display = ghCreatePrChk?.checked ? 'flex' : 'none';\n        }\n        if (ghScopeSelected!.checked) persistGhState({ scope: 'selected' });\n        updateExportCommitEnabled();\n      });\n    }\n\n    if (ghScopeAll) {\n      ghScopeAll.addEventListener('change', () => {\n        if (ghScopeAll!.checked) persistGhState({ scope: 'all' });\n        updateExportCommitEnabled();\n      });\n    }\n\n    if (ghScopeTypography) {\n      ghScopeTypography.addEventListener('change', () => {\n        if (ghScopeTypography!.checked) persistGhState({ scope: 'typography' });\n        if (ghPrOptionsEl) ghPrOptionsEl.style.display = ghCreatePrChk?.checked ? 'flex' : 'none';\n        updateExportCommitEnabled();\n      });\n    }\n\n    if (ghCreatePrChk) {\n      ghCreatePrChk.addEventListener('change', () => {\n        const on = !!ghCreatePrChk!.checked;\n        if (ghPrOptionsEl) ghPrOptionsEl.style.display = on ? 'flex' : 'none';\n        const save: Partial<{ createPr: boolean; prBase: string }> = { createPr: on };\n        if (on) save.prBase = getPrBaseBranch();\n        persistGhState(save);\n        updateExportCommitEnabled();\n      });\n    }\n\n    if (ghPrTitleInput) {\n      ghPrTitleInput.addEventListener('input', () => {\n        persistGhState({ prTitle: ghPrTitleInput!.value });\n      });\n    }\n\n    if (ghPrBodyInput) {\n      ghPrBodyInput.addEventListener('input', () => {\n        persistGhState({ prBody: ghPrBodyInput!.value });\n      });\n    }\n\n    if (ghFetchPathInput) ghFetchPathInput.addEventListener('input', updateFetchButtonEnabled);\n\n    if (ghFetchTokensBtn) {\n      ghFetchTokensBtn.addEventListener('click', () => {\n        const branch = getCurrentBranch();\n        const path = (ghFetchPathInput?.value || '').trim().replace(/^\\/+/, '');\n        if (!currentOwner || !currentRepo) { deps.log('Pick a repository first.'); return; }\n        if (!branch) { deps.log('Pick a branch first.'); return; }\n        if (!path) { deps.log('Enter a path to fetch (e.g., tokens/tokens.json).'); return; }\n        deps.log(`GitHub: fetching ${path} from ${currentOwner}/${currentRepo}@${branch}\u2026`);\n        const allowHex = !!pickAllowHexCheckbox()?.checked;\n        const contexts = deps.getImportContexts();\n        const payload: UiToPlugin = {\n          type: 'GITHUB_FETCH_TOKENS',\n          payload: {\n            owner: currentOwner,\n            repo: currentRepo,\n            branch,\n            path,\n            allowHexStrings: allowHex,\n            ...(contexts.length > 0 ? { contexts } : {})\n          }\n        };\n        deps.postToPlugin(payload);\n        if (contexts.length > 0) {\n          deps.log(`GitHub: importing ${contexts.length} selected mode(s) based on current scope.`);\n        }\n      });\n    }\n\n    if (ghExportAndCommitBtn) {\n      ghExportAndCommitBtn.addEventListener('click', () => {\n        const collectionSelect = pickCollectionSelect();\n        const modeSelect = pickModeSelect();\n\n        const scope: GithubScope = ghScopeAll && ghScopeAll.checked\n          ? 'all'\n          : (ghScopeTypography && ghScopeTypography.checked ? 'typography' : 'selected');\n        const commitMessage = (ghCommitMsgInput?.value || 'Update tokens from Figma').trim();\n        const normalizedFolder = normalizeFolderInput(ghFolderInput?.value || '');\n\n        if (!normalizedFolder.display) {\n          deps.log('Pick a destination folder (e.g., tokens/).');\n          ghFolderInput?.focus();\n          updateExportCommitEnabled();\n          return;\n        }\n\n        if (ghFolderInput) ghFolderInput.value = normalizedFolder.display;\n        deps.postToPlugin({\n          type: 'GITHUB_SET_FOLDER',\n          payload: { owner: currentOwner, repo: currentRepo, folder: normalizedFolder.payload }\n        });\n        persistGhState({ folder: normalizedFolder.payload });\n\n        const createPr = !!(ghCreatePrChk && ghCreatePrChk.checked);\n        const payload: UiToPlugin = {\n          type: 'GITHUB_EXPORT_AND_COMMIT',\n          payload: {\n            owner: currentOwner,\n            repo: currentRepo,\n            branch: getCurrentBranch(),\n            folder: normalizedFolder.payload,\n            commitMessage,\n            scope,\n            styleDictionary: !!(pickStyleDictionaryCheckbox()?.checked),\n            flatTokens: !!(pickFlatTokensCheckbox()?.checked),\n            createPr\n          }\n        };\n\n        if (scope === 'selected' && collectionSelect && modeSelect) {\n          payload.payload.collection = collectionSelect.value || '';\n          payload.payload.mode = modeSelect.value || '';\n        }\n\n        if (createPr) {\n          payload.payload.prBase = getPrBaseBranch();\n          payload.payload.prTitle = (ghPrTitleInput?.value || '').trim();\n          payload.payload.prBody = ghPrBodyInput?.value || '';\n        }\n\n        deps.log(createPr ? 'Export, Commit & PR requested\u2026' : 'Export & Commit requested\u2026');\n        deps.postToPlugin(payload);\n      });\n    }\n\n    doc.addEventListener('keydown', handleFolderPickerKeydown);\n\n    updateGhStatusUi();\n    updateFolderControlsEnabled();\n    updateExportCommitEnabled();\n    updateFetchButtonEnabled();\n  }\n\n  function onGitHubConnectClick(): void {\n    const tokenRaw = readPatFromUi();\n    const isMasked = ghTokenInput?.getAttribute('data-filled') === '1';\n    if (ghIsAuthed && isMasked) return;\n    if (!tokenRaw) { deps.log('GitHub: Paste a Personal Access Token first.'); return; }\n    const remember = !!(ghRememberChk && ghRememberChk.checked);\n    deps.log('GitHub: Verifying token\u2026');\n    deps.postToPlugin({ type: 'GITHUB_SET_TOKEN', payload: { token: tokenRaw, remember } });\n  }\n\n  function onGitHubVerifyClick(): void {\n    onGitHubConnectClick();\n  }\n\n  function onGitHubLogoutClick(): void {\n    deps.postToPlugin({ type: 'GITHUB_FORGET_TOKEN' });\n    ghIsAuthed = false;\n    ghTokenExpiresAt = null;\n    setPatFieldObfuscated(false);\n    populateGhRepos([]);\n    updateGhStatusUi();\n    currentOwner = ''; currentRepo = '';\n    allBranches = []; filteredBranches = [];\n    desiredBranch = null; defaultBranchFromApi = undefined;\n    loadedPages = 0; hasMorePages = false; isFetchingBranches = false;\n    if (ghBranchSearch) ghBranchSearch.value = '';\n    if (ghBranchSelect) setBranchDisabled(true, 'Pick a repository first\u2026');\n    updateBranchCount();\n    updateFolderControlsEnabled();\n    if (ghFolderInput) ghFolderInput.value = '';\n    deps.log('GitHub: Logged out.');\n  }\n\n  function handleMessage(msg: PluginToUi): boolean {\n    if (msg.type === 'GITHUB_AUTH_RESULT') {\n      const p = msg.payload || {} as any;\n      ghIsAuthed = !!p.ok;\n      ghTokenExpiresAt =\n        (typeof p.exp !== 'undefined' && p.exp !== null)\n          ? p.exp\n          : ((typeof p.tokenExpiration !== 'undefined' && p.tokenExpiration !== null) ? p.tokenExpiration : null);\n\n      if (typeof p.remember === 'boolean') {\n        ghRememberPref = p.remember;\n        saveRememberPref(ghRememberPref);\n      } else {\n        ghRememberPref = loadRememberPref();\n      }\n\n      if (ghIsAuthed) {\n        setPatFieldObfuscated(true);\n        const who = p.login || 'unknown';\n        const name = p.name ? ` (${p.name})` : '';\n        deps.log(`GitHub: Authenticated as ${who}${name}.`);\n      } else {\n        setPatFieldObfuscated(false);\n        const why = p.error ? `: ${p.error}` : '.';\n        deps.log(`GitHub: Authentication failed${why}`);\n      }\n\n      updateGhStatusUi();\n      updateExportCommitEnabled();\n      updateFetchButtonEnabled();\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_REPOS') {\n      const repos = (msg.payload?.repos ?? []) as Array<{ full_name: string; default_branch: string; private: boolean }>;\n      populateGhRepos(repos);\n      deps.log(`GitHub: Repository list updated (${repos.length}).`);\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_RESTORE_SELECTED') {\n      const p = msg.payload || {};\n      currentOwner = typeof p.owner === 'string' ? p.owner : '';\n      currentRepo = typeof p.repo === 'string' ? p.repo : '';\n      desiredBranch = typeof p.branch === 'string' ? p.branch : null;\n\n      if (typeof p.folder === 'string' && ghFolderInput) {\n        const normalized = normalizeFolderInput(p.folder);\n        ghFolderInput.value = normalized.display;\n      }\n      if (typeof p.commitMessage === 'string' && ghCommitMsgInput) {\n        ghCommitMsgInput.value = p.commitMessage;\n      }\n      if (typeof p.scope === 'string') {\n        if (p.scope === 'all' && ghScopeAll) ghScopeAll.checked = true;\n        if (p.scope === 'selected' && ghScopeSelected) ghScopeSelected.checked = true;\n        if (p.scope === 'typography' && ghScopeTypography) ghScopeTypography.checked = true;\n      }\n      const styleDictChk = pickStyleDictionaryCheckbox();\n      if (styleDictChk && typeof p.styleDictionary === 'boolean') {\n        styleDictChk.checked = p.styleDictionary;\n      }\n      const flatChk = pickFlatTokensCheckbox();\n      if (flatChk && typeof p.flatTokens === 'boolean') {\n        flatChk.checked = p.flatTokens;\n      }\n      if (typeof p.createPr === 'boolean' && ghCreatePrChk) {\n        ghCreatePrChk.checked = p.createPr;\n        if (ghPrOptionsEl) ghPrOptionsEl.style.display = p.createPr ? 'flex' : 'none';\n      }\n      if (typeof p.prTitle === 'string' && ghPrTitleInput) ghPrTitleInput.value = p.prTitle;\n      if (typeof p.prBody === 'string' && ghPrBodyInput) ghPrBodyInput.value = p.prBody;\n\n      updateExportCommitEnabled();\n      updateFetchButtonEnabled();\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_BRANCHES') {\n      const pl = (msg.payload || {}) as any;\n      const owner = String(pl.owner || '');\n      const repo = String(pl.repo || '');\n      if (owner !== currentOwner || repo !== currentRepo) return true;\n\n      lastBranchesFetchedAtMs = Date.now();\n\n      loadedPages = Number(pl.page || 1);\n      hasMorePages = !!pl.hasMore;\n      isFetchingBranches = false;\n\n      if (typeof pl.defaultBranch === 'string' && !defaultBranchFromApi) {\n        defaultBranchFromApi = pl.defaultBranch;\n      }\n\n      if (ghNewBranchBtn) ghNewBranchBtn.disabled = false;\n\n      const names = Array.isArray(pl.branches) ? (pl.branches as Array<{ name: string }>).map(b => b.name) : [];\n      const set = new Set(allBranches);\n      for (const n of names) if (n) set.add(n);\n      allBranches = Array.from(set).sort((a, b) => a.localeCompare(b));\n\n      applyBranchFilter();\n      setBranchDisabled(false);\n      updateFolderControlsEnabled();\n\n      const rate = pl.rate as { remaining?: number; resetEpochSec?: number } | undefined;\n      if (rate && typeof rate.remaining === 'number' && rate.remaining <= 3 && typeof rate.resetEpochSec === 'number') {\n        const t = new Date(rate.resetEpochSec * 1000).toLocaleTimeString();\n        deps.log(`GitHub: near rate limit; resets ~${t}`);\n      }\n\n      deps.log(`Loaded ${names.length} branches (page ${loadedPages}) for ${repo}${hasMorePages ? '\u2026' : ''}`);\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_BRANCHES_ERROR') {\n      const pl = (msg.payload || {}) as any;\n      const owner = String(pl.owner || '');\n      const repo = String(pl.repo || '');\n      if (owner !== currentOwner || repo !== currentRepo) return true;\n      isFetchingBranches = false;\n      setBranchDisabled(false);\n      updateFolderControlsEnabled();\n      deps.log(`Branch load failed (status ${pl.status}): ${pl.message || 'unknown error'}`);\n      if (pl.samlRequired) deps.log('This org requires SSO. Open the repo in your browser and authorize SSO for your token.');\n      if (pl.rate && typeof pl.rate.resetEpochSec === 'number') {\n        const t = new Date(pl.rate.resetEpochSec * 1000).toLocaleTimeString();\n        deps.log(`Rate limit issue; resets ~${t}`);\n      }\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_CREATE_BRANCH_RESULT') {\n      const pl = (msg.payload || {}) as any;\n      if (ghCreateBranchConfirmBtn) ghCreateBranchConfirmBtn.disabled = false;\n      if (typeof pl.ok !== 'boolean') return true;\n\n      if (pl.ok) {\n        const baseBranch = String(pl.baseBranch || '');\n        const newBranch = String(pl.newBranch || '');\n        const url = String(pl.html_url || '');\n\n        if (newBranch) {\n          const s = new Set(allBranches);\n          if (!s.has(newBranch)) {\n            s.add(newBranch);\n            allBranches = Array.from(s).sort((a, b) => a.localeCompare(b));\n          }\n          desiredBranch = newBranch;\n          applyBranchFilter();\n          if (ghBranchSelect) ghBranchSelect.value = newBranch;\n        }\n\n        updateFolderControlsEnabled();\n        showNewBranchRow(false);\n        if (ghNewBranchName) ghNewBranchName.value = '';\n\n        if (url) {\n          deps.log(`Branch created: ${newBranch} (from ${baseBranch})`);\n          const logEl = deps.getLogElement();\n          if (logEl && doc) {\n            const wrap = doc.createElement('div');\n            const a = doc.createElement('a');\n            a.href = url;\n            a.target = '_blank';\n            a.textContent = 'View on GitHub';\n            wrap.appendChild(a);\n            logEl.appendChild(wrap);\n            (logEl as HTMLElement).scrollTop = (logEl as HTMLElement).scrollHeight;\n          }\n        } else {\n          deps.log(`Branch created: ${newBranch} (from ${baseBranch})`);\n        }\n        return true;\n      }\n\n      const status = pl.status ?? 0;\n      const message = pl.message || 'unknown error';\n      deps.log(`Create branch failed (status ${status}): ${message}`);\n      if (pl.samlRequired) {\n        deps.log('This org requires SSO. Open the repo in your browser and authorize SSO for your token.');\n      } else if (status === 403) {\n        if (pl.noPushPermission) {\n          deps.log('You do not have push permission to this repository. Ask a maintainer for write access.');\n        } else {\n          deps.log('Likely a token permission issue:');\n          deps.log('\u2022 Classic PAT: add the \"repo\" scope (or \"public_repo\" for public repos).');\n          deps.log('\u2022 Fine-grained PAT: grant this repository and set \"Contents: Read and write\".');\n        }\n      }\n      if (pl.rate && typeof pl.rate.resetEpochSec === 'number') {\n        const t = new Date(pl.rate.resetEpochSec * 1000).toLocaleTimeString();\n        deps.log(`Rate limit issue; resets ~${t}`);\n      }\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_FOLDER_LIST_RESULT') {\n      const pl = (msg.payload || {}) as any;\n      const path = String(pl.path || '').replace(/^\\/+|\\/+$/g, '');\n      const ok = !!pl.ok;\n      const entries = Array.isArray(pl.entries) ? pl.entries : [];\n      const message = String(pl.message || '');\n\n      for (let i = 0; i < folderListWaiters.length; i++) {\n        if (folderListWaiters[i].path === path) {\n          const waiter = folderListWaiters.splice(i, 1)[0];\n          if (ok) waiter.resolve({ ok: true, entries });\n          else waiter.reject({ ok: false, message: message || `HTTP ${pl.status || 0}` });\n          break;\n        }\n      }\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_CREATE_FOLDER_RESULT') {\n      const pl = (msg.payload || {}) as any;\n      const fp = String(pl.folderPath || '').replace(/^\\/+|\\/+$/g, '');\n      const ok = !!pl.ok;\n      const message = String(pl.message || '');\n\n      for (let i = 0; i < folderCreateWaiters.length; i++) {\n        if (folderCreateWaiters[i].folderPath === fp) {\n          const waiter = folderCreateWaiters.splice(i, 1)[0];\n          if (ok) waiter.resolve({ ok: true });\n          else waiter.reject({ ok: false, message: message || `HTTP ${pl.status || 0}`, status: pl.status });\n          break;\n        }\n      }\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_COMMIT_RESULT') {\n      if (msg.payload.ok) {\n        const url = String(msg.payload.commitUrl || '');\n        const branch = msg.payload.branch || '';\n        deps.log(`Commit succeeded: ${url || '(no URL)'} (${branch})`);\n        if (url) {\n          const logEl = deps.getLogElement();\n          if (logEl && doc) {\n            const wrap = doc.createElement('div');\n            const a = doc.createElement('a');\n            a.href = url;\n            a.target = '_blank';\n            a.textContent = 'View commit';\n            wrap.appendChild(a);\n            logEl.appendChild(wrap);\n            (logEl as HTMLElement).scrollTop = (logEl as HTMLElement).scrollHeight;\n          }\n        }\n        if (msg.payload.createdPr) {\n          const pr = msg.payload.createdPr;\n          deps.log(`PR prepared (#${pr.number}) from ${pr.head} \u2192 ${pr.base}`);\n        }\n      } else {\n        const status = typeof msg.payload.status === 'number' ? msg.payload.status : 0;\n        const message = msg.payload.message || 'unknown error';\n        if (status === 304) {\n          deps.log(`Commit skipped: ${message}`);\n        } else {\n          deps.log(`Commit failed (${status}): ${message}`);\n        }\n      }\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_PR_RESULT') {\n      if (msg.payload.ok) {\n        deps.log(`PR created: #${msg.payload.number} (${msg.payload.head} \u2192 ${msg.payload.base})`);\n        const url = msg.payload.url;\n        if (url) {\n          const logEl = deps.getLogElement();\n          if (logEl && doc) {\n            const wrap = doc.createElement('div');\n            const a = doc.createElement('a');\n            a.href = url;\n            a.target = '_blank';\n            a.textContent = 'View PR';\n            wrap.appendChild(a);\n            logEl.appendChild(wrap);\n            (logEl as HTMLElement).scrollTop = (logEl as HTMLElement).scrollHeight;\n          }\n        }\n      } else {\n        deps.log(`PR creation failed (${msg.payload.status || 0}): ${msg.payload.message || 'unknown error'}`);\n      }\n      return true;\n    }\n\n    if (msg.type === 'GITHUB_FETCH_TOKENS_RESULT') {\n      if (msg.payload.ok) {\n        deps.log(`Imported tokens from ${msg.payload.path} (${msg.payload.branch})`);\n      } else {\n        deps.log(`GitHub fetch failed (${msg.payload.status || 0}): ${msg.payload.message || 'unknown error'}`);\n      }\n      return true;\n    }\n\n    return false;\n  }\n\n  function onSelectionChange(): void {\n    updateExportCommitEnabled();\n  }\n\n  return {\n    attach,\n    handleMessage,\n    onSelectionChange\n  };\n}\n", "// src/app/ui.ts\n// In-panel UI logic for the plugin: dom wiring, GitHub workflows, and export helpers.\n// - Mirrors plugin state via postMessage so the UI can function offline\n// - Provides guarded DOM helpers to survive partial renders or optional features\n\nimport type { PluginToUi, UiToPlugin, ImportSummary } from './messages';\nimport { createGithubUi } from './github/ui';\n\n/* -------------------------------------------------------\n * Globals (assigned after DOMContentLoaded)\n * ----------------------------------------------------- */\nlet logEl: HTMLElement | null = null;\nlet rawEl: HTMLElement | null = null;\n\nlet exportAllChk: HTMLInputElement | null = null;\nlet collectionSelect: HTMLSelectElement | null = null;\nlet modeSelect: HTMLSelectElement | null = null;\n\nlet fileInput: HTMLInputElement | null = null;\nlet importBtn: HTMLButtonElement | null = null;\nlet exportBtn: HTMLButtonElement | null = null;\nlet exportTypographyBtn: HTMLButtonElement | null = null;\nlet exportPickers: HTMLElement | null = null;\n\nlet refreshBtn: HTMLButtonElement | null = null;\n\nlet shellEl: HTMLElement | null = null;\nlet drawerToggleBtn: HTMLButtonElement | null = null;\nlet resizeHandleEl: HTMLElement | null = null;\n\nlet w3cPreviewEl: HTMLElement | null = null;\n\nlet copyRawBtn: HTMLButtonElement | null = null;\nlet copyW3cBtn: HTMLButtonElement | null = null;\nlet copyLogBtn: HTMLButtonElement | null = null;\n\nlet allowHexChk: HTMLInputElement | null = null;\nlet styleDictionaryChk: HTMLInputElement | null = null;\nlet flatTokensChk: HTMLInputElement | null = null;\n\nlet importScopeOverlay: HTMLElement | null = null;\nlet importScopeBody: HTMLElement | null = null;\nlet importScopeConfirmBtn: HTMLButtonElement | null = null;\nlet importScopeCancelBtn: HTMLButtonElement | null = null;\nlet importScopeRememberChk: HTMLInputElement | null = null;\nlet importScopeMissingEl: HTMLElement | null = null;\n\nlet importScopeSummaryEl: HTMLElement | null = null;\nlet importScopeSummaryTextEl: HTMLElement | null = null;\nlet importScopeClearBtn: HTMLButtonElement | null = null;\n\nlet importSkipLogListEl: HTMLElement | null = null;\nlet importSkipLogEmptyEl: HTMLElement | null = null;\n\n\n/* -------------------------------------------------------\n * Shared helpers\n * ----------------------------------------------------- */\n\nconst IMPORT_PREF_KEY = 'dtcg.importPreference.v1';\nconst IMPORT_LOG_KEY = 'dtcg.importLog.v1';\n\ntype ImportContextOption = { context: string; collection: string; mode: string };\ntype ImportPreference = { contexts: string[]; updatedAt: number };\ntype ImportLogEntry = { timestamp: number; source?: 'local' | 'github'; summary: ImportSummary };\ntype ImportScopeModalState = {\n  options: ImportContextOption[];\n  collections: string[];\n  inputs: HTMLInputElement[];\n  inputsByCollection: Map<string, HTMLInputElement[]>;\n  onConfirm: (selected: string[], remember: boolean) => void;\n};\n\nlet importPreference: ImportPreference | null = null;\nlet importLogEntries: ImportLogEntry[] = [];\nlet importScopeModalState: ImportScopeModalState | null = null;\nlet lastImportSelection: string[] = [];\n\nfunction prettyExportName(original: string | undefined | null): string {\n  const name = (original && typeof original === 'string') ? original : 'tokens.json';\n  const m = name.match(/^(.*)_mode=(.*)\\.tokens\\.json$/);\n  if (m) {\n    const collection = m[1].trim();\n    const mode = m[2].trim();\n    return `${collection} - ${mode}.json`;\n  }\n  return name.endsWith('.json') ? name : (name + '.json');\n}\n\nlet pendingSave: { writable: FileSystemWritableFileStream, name: string } | null = null;\n\nfunction supportsFilePicker(): boolean {\n  return typeof (window as any).showSaveFilePicker === 'function';\n}\n\nasync function beginPendingSave(suggestedName: string): Promise<boolean> {\n  try {\n    if (!supportsFilePicker()) return false;\n    const handle = await (window as any).showSaveFilePicker({\n      suggestedName,\n      types: [{ description: 'JSON', accept: { 'application/json': ['.json'] } }]\n    });\n    const writable: FileSystemWritableFileStream = await handle.createWritable();\n    pendingSave = { writable, name: suggestedName };\n    return true;\n  } catch {\n    pendingSave = null;\n    return false;\n  }\n}\n\nasync function finishPendingSave(text: string): Promise<boolean> {\n  if (!pendingSave) return false;\n  try {\n    await pendingSave.writable.write(new Blob([text], { type: 'application/json' }));\n    await pendingSave.writable.close();\n    return true;\n  } catch {\n    try { await pendingSave.writable.close(); } catch { /* ignore */ }\n    return false;\n  } finally {\n    pendingSave = null;\n  }\n}\n\nfunction triggerJsonDownload(filename: string, text: string): void {\n  try {\n    const blob = new Blob([text], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    a.style.position = 'absolute';\n    a.style.left = '-9999px';\n    document.body.appendChild(a);\n    a.click();\n    setTimeout(() => { URL.revokeObjectURL(url); a.remove(); }, 0);\n  } catch { /* ignore */ }\n}\n\nfunction copyElText(el: HTMLElement | null, label: string): void {\n  if (!el) return;\n  try {\n    const text = el.textContent ?? '';\n    if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {\n      navigator.clipboard.writeText(text).then(() => {\n        log(`Copied ${label} to clipboard.`);\n      }).catch(() => {\n        throw new Error('clipboard write failed');\n      });\n      return;\n    }\n\n    const ta = document.createElement('textarea');\n    ta.value = text;\n    ta.style.position = 'fixed';\n    ta.style.opacity = '0';\n    document.body.appendChild(ta);\n    ta.select();\n    ta.setSelectionRange(0, ta.value.length);\n\n    const ok = document.execCommand('copy');\n    document.body.removeChild(ta);\n\n    if (ok) log(`Copied ${label} to clipboard (${text.length} chars).`);\n    else throw new Error('execCommand(copy) returned false');\n  } catch {\n    log(`Could not copy ${label}.`);\n  }\n}\n\n/* -------------------------------------------------------\n * Partial import helpers\n * ----------------------------------------------------- */\n\nfunction normalizeContextList(list: string[]): string[] {\n  const seen = new Set<string>();\n  const out: string[] = [];\n  for (let i = 0; i < list.length; i++) {\n    const raw = String(list[i] ?? '').trim();\n    if (!raw) continue;\n    if (seen.has(raw)) continue;\n    seen.add(raw);\n    out.push(raw);\n  }\n  out.sort((a, b) => (a < b ? -1 : a > b ? 1 : 0));\n  return out;\n}\n\nfunction contextsEqual(a: string[], b: string[]): boolean {\n  if (a.length !== b.length) return false;\n  for (let i = 0; i < a.length; i++) if (a[i] !== b[i]) return false;\n  return true;\n}\n\nfunction saveImportPreference(): void {\n  if (!importPreference || importPreference.contexts.length === 0) {\n    try { window.localStorage?.removeItem(IMPORT_PREF_KEY); } catch { /* ignore */ }\n    return;\n  }\n  try { window.localStorage?.setItem(IMPORT_PREF_KEY, JSON.stringify(importPreference)); } catch { /* ignore */ }\n}\n\nfunction loadImportPreference(): void {\n  importPreference = null;\n  try {\n    const raw = window.localStorage?.getItem(IMPORT_PREF_KEY);\n    if (!raw) return;\n    const parsed = JSON.parse(raw);\n    if (!parsed || typeof parsed !== 'object') return;\n    const ctxs = Array.isArray((parsed as any).contexts) ? normalizeContextList((parsed as any).contexts as string[]) : [];\n    const ts = typeof (parsed as any).updatedAt === 'number' ? Number((parsed as any).updatedAt) : Date.now();\n    if (ctxs.length > 0) importPreference = { contexts: ctxs, updatedAt: ts };\n  } catch { importPreference = null; }\n}\n\nfunction setImportPreference(contexts: string[]): void {\n  const normalized = normalizeContextList(contexts);\n  if (normalized.length === 0) {\n    clearImportPreference(false);\n    return;\n  }\n  const same = importPreference && contextsEqual(importPreference.contexts, normalized);\n  importPreference = { contexts: normalized, updatedAt: Date.now() };\n  saveImportPreference();\n  renderImportPreferenceSummary();\n  if (!same) log('Remembered import selection for future imports.');\n}\n\nfunction clearImportPreference(logChange: boolean): void {\n  if (!importPreference) return;\n  importPreference = null;\n  try { window.localStorage?.removeItem(IMPORT_PREF_KEY); } catch { /* ignore */ }\n  renderImportPreferenceSummary();\n  if (logChange) log('Cleared remembered import selection. Next import will prompt for modes.');\n}\n\nfunction formatContextList(contexts: string[]): string {\n  const normalized = normalizeContextList(contexts);\n  if (normalized.length === 0) return 'All contexts';\n  const grouped = new Map<string, string[]>();\n  for (let i = 0; i < normalized.length; i++) {\n    const ctx = normalized[i];\n    const slash = ctx.indexOf('/');\n    const collection = slash >= 0 ? ctx.slice(0, slash) : ctx;\n    const mode = slash >= 0 ? ctx.slice(slash + 1) : 'Mode 1';\n    const coll = collection ? collection : 'Tokens';\n    const modes = grouped.get(coll) || [];\n    if (!grouped.has(coll)) grouped.set(coll, modes);\n    if (!modes.includes(mode)) modes.push(mode);\n  }\n  const parts: string[] = [];\n  const collections = Array.from(grouped.keys()).sort((a, b) => (a < b ? -1 : a > b ? 1 : 0));\n  for (let i = 0; i < collections.length; i++) {\n    const coll = collections[i];\n    const modes = grouped.get(coll) || [];\n    modes.sort((a, b) => (a < b ? -1 : a > b ? 1 : 0));\n    parts.push(`${coll} (${modes.join(', ')})`);\n  }\n  return parts.join('; ');\n}\n\nfunction renderImportPreferenceSummary(): void {\n  if (!importScopeSummaryEl || !importScopeSummaryTextEl) return;\n  const hasPref = !!importPreference && importPreference.contexts.length > 0;\n  if (importScopeClearBtn) importScopeClearBtn.disabled = !hasPref;\n  if (!hasPref) {\n    importScopeSummaryEl.hidden = true;\n    return;\n  }\n  importScopeSummaryEl.hidden = false;\n  const when = new Date(importPreference!.updatedAt).toLocaleString();\n  importScopeSummaryTextEl.textContent = `Remembered import scope (${when}): ${formatContextList(importPreference!.contexts)}.`;\n}\n\nfunction saveImportLog(): void {\n  try { window.localStorage?.setItem(IMPORT_LOG_KEY, JSON.stringify(importLogEntries)); } catch { /* ignore */ }\n}\n\nfunction loadImportLog(): void {\n  importLogEntries = [];\n  try {\n    const raw = window.localStorage?.getItem(IMPORT_LOG_KEY);\n    if (!raw) return;\n    const parsed = JSON.parse(raw);\n    if (!Array.isArray(parsed)) return;\n    for (let i = 0; i < parsed.length; i++) {\n      const entry = parsed[i];\n      if (!entry || typeof entry !== 'object') continue;\n      const timestamp = typeof (entry as any).timestamp === 'number' ? Number((entry as any).timestamp) : null;\n      const summary = (entry as any).summary as ImportSummary | undefined;\n      const source = (entry as any).source === 'github' ? 'github' : (entry as any).source === 'local' ? 'local' : undefined;\n      if (!timestamp || !summary || typeof summary !== 'object') continue;\n      if (!Array.isArray(summary.appliedContexts) || !Array.isArray(summary.availableContexts)) continue;\n      if (!Array.isArray(summary.tokensWithRemovedContexts)) {\n        (summary as any).tokensWithRemovedContexts = [];\n      }\n      if (!Array.isArray(summary.skippedContexts)) {\n        (summary as any).skippedContexts = [];\n      }\n      if (!Array.isArray(summary.missingRequestedContexts)) {\n        (summary as any).missingRequestedContexts = [];\n      }\n      if (typeof summary.createdStyles !== 'number' || !isFinite(summary.createdStyles)) {\n        (summary as any).createdStyles = 0;\n      }\n      importLogEntries.push({ timestamp, summary, source });\n    }\n    importLogEntries.sort((a, b) => a.timestamp - b.timestamp);\n  } catch { importLogEntries = []; }\n}\n\nfunction renderImportLog(): void {\n  if (!(importSkipLogListEl && importSkipLogEmptyEl)) return;\n  importSkipLogListEl.innerHTML = '';\n  if (!importLogEntries || importLogEntries.length === 0) {\n    importSkipLogEmptyEl.hidden = false;\n    return;\n  }\n  importSkipLogEmptyEl.hidden = true;\n\n  for (let idx = importLogEntries.length - 1; idx >= 0; idx--) {\n    const entry = importLogEntries[idx];\n    const container = document.createElement('div');\n    container.className = 'import-skip-log-entry';\n\n    const header = document.createElement('div');\n    header.className = 'import-skip-log-entry-header';\n    const label = entry.source === 'github' ? 'GitHub import' : 'Manual import';\n    header.textContent = `${label} \u2022 ${new Date(entry.timestamp).toLocaleString()}`;\n    container.appendChild(header);\n\n    const stats = document.createElement('div');\n    stats.className = 'import-skip-log-entry-stats';\n    const tokensText = `Imported ${entry.summary.importedTokens} of ${entry.summary.totalTokens} tokens.`;\n    const stylesCreated = typeof entry.summary.createdStyles === 'number'\n      ? entry.summary.createdStyles\n      : undefined;\n    if (typeof stylesCreated === 'number') {\n      const stylesLabel = stylesCreated === 1 ? 'style' : 'styles';\n      stats.textContent = `${tokensText} ${stylesCreated} ${stylesLabel} created.`;\n    } else {\n      stats.textContent = tokensText;\n    }\n    container.appendChild(stats);\n\n    const contextsLine = document.createElement('div');\n    contextsLine.className = 'import-skip-log-entry-contexts';\n    contextsLine.textContent = 'Applied: ' + formatContextList(entry.summary.appliedContexts);\n    container.appendChild(contextsLine);\n\n    if (entry.summary.skippedContexts.length > 0) {\n      const skippedLine = document.createElement('div');\n      skippedLine.className = 'import-skip-log-entry-contexts';\n      skippedLine.textContent = 'Skipped modes: ' + formatContextList(entry.summary.skippedContexts.map(s => s.context));\n      container.appendChild(skippedLine);\n    }\n\n    if (entry.summary.missingRequestedContexts.length > 0) {\n      const missingLine = document.createElement('div');\n      missingLine.className = 'import-skip-log-entry-note';\n      missingLine.textContent = 'Not found in file: ' + formatContextList(entry.summary.missingRequestedContexts);\n      container.appendChild(missingLine);\n    }\n\n    if (entry.summary.selectionFallbackToAll) {\n      const fallbackLine = document.createElement('div');\n      fallbackLine.className = 'import-skip-log-entry-note';\n      fallbackLine.textContent = 'Requested modes were missing; imported all contexts instead.';\n      container.appendChild(fallbackLine);\n    }\n\n    if (entry.summary.tokensWithRemovedContexts.length > 0) {\n      const tokenList = document.createElement('ul');\n      tokenList.className = 'import-skip-log-token-list';\n      const maxTokens = Math.min(entry.summary.tokensWithRemovedContexts.length, 10);\n      for (let t = 0; t < maxTokens; t++) {\n        const tok = entry.summary.tokensWithRemovedContexts[t];\n        const li = document.createElement('li');\n        const removedLabel = tok.removedContexts.length > 0 ? formatContextList(tok.removedContexts) : 'none';\n        const keptLabel = tok.keptContexts.length > 0 ? formatContextList(tok.keptContexts) : '';\n        li.textContent = `${tok.path} \u2014 skipped ${removedLabel}${keptLabel ? '; kept ' + keptLabel : ''}`;\n        tokenList.appendChild(li);\n      }\n      if (entry.summary.tokensWithRemovedContexts.length > maxTokens) {\n        const more = document.createElement('li');\n        more.textContent = `\u2026and ${entry.summary.tokensWithRemovedContexts.length - maxTokens} more token(s).`;\n        tokenList.appendChild(more);\n      }\n      container.appendChild(tokenList);\n    }\n\n    if (entry.summary.skippedContexts.length > 0 && importPreference && importPreference.contexts.length > 0) {\n      const tip = document.createElement('div');\n      tip.className = 'import-skip-log-entry-note';\n      tip.textContent = 'Tip: Clear the remembered import selection to restore skipped modes.';\n      container.appendChild(tip);\n    }\n\n    importSkipLogListEl.appendChild(container);\n  }\n}\n\nfunction addImportLogEntry(entry: ImportLogEntry): void {\n  importLogEntries.push(entry);\n  if (importLogEntries.length > 10) {\n    importLogEntries = importLogEntries.slice(importLogEntries.length - 10);\n  }\n  saveImportLog();\n  renderImportLog();\n}\n\nfunction collectContextsFromJson(root: unknown): ImportContextOption[] {\n  const grouped = new Map<string, Set<string>>();\n\n  function visit(node: unknown, path: string[]): void {\n    if (Array.isArray(node)) {\n      for (let i = 0; i < node.length; i++) visit(node[i], path);\n      return;\n    }\n    if (!node || typeof node !== 'object') return;\n\n    const obj = node as Record<string, unknown>;\n    if (Object.prototype.hasOwnProperty.call(obj, '$value')) {\n      const rawCollection = path[0] ? String(path[0]).trim() : 'Tokens';\n      let mode = 'Mode 1';\n      try {\n        const ext = obj['$extensions'];\n        if (ext && typeof ext === 'object') {\n          const cf = (ext as any)['com.figma'];\n          if (cf && typeof cf === 'object' && typeof (cf as any).modeName === 'string') {\n            const candidate = String((cf as any).modeName).trim();\n            if (candidate) mode = candidate;\n          }\n        }\n      } catch { /* ignore */ }\n      const collection = rawCollection ? rawCollection : 'Tokens';\n      const set = grouped.get(collection) || new Set<string>();\n      if (!grouped.has(collection)) grouped.set(collection, set);\n      set.add(mode);\n      return;\n    }\n\n    for (const key in obj) {\n      if (!Object.prototype.hasOwnProperty.call(obj, key)) continue;\n      if (key.startsWith('$')) continue;\n      visit((obj as any)[key], path.concat(String(key)));\n    }\n  }\n\n  visit(root, []);\n\n  const options: ImportContextOption[] = [];\n  const collections = Array.from(grouped.keys()).sort((a, b) => (a < b ? -1 : a > b ? 1 : 0));\n  for (let i = 0; i < collections.length; i++) {\n    const collection = collections[i];\n    const modes = Array.from(grouped.get(collection) || []).sort((a, b) => (a < b ? -1 : a > b ? 1 : 0));\n    for (let j = 0; j < modes.length; j++) {\n      const mode = modes[j];\n      options.push({ context: `${collection}/${mode}`, collection, mode });\n    }\n  }\n  return options;\n}\n\nfunction updateImportScopeConfirmState(): void {\n  if (!importScopeModalState) return;\n  const state = importScopeModalState;\n  let allCollectionsSelected = true;\n  for (let i = 0; i < state.collections.length; i++) {\n    const collection = state.collections[i];\n    const inputs = state.inputsByCollection.get(collection) || [];\n    if (!inputs.some(input => input.checked)) {\n      allCollectionsSelected = false;\n      break;\n    }\n  }\n  if (importScopeConfirmBtn) {\n    importScopeConfirmBtn.disabled = !allCollectionsSelected;\n    const label = state.collections.length > 1 ? 'Import selected modes' : 'Import selected mode';\n    importScopeConfirmBtn.textContent = label;\n  }\n}\n\nlet importScopeKeyListenerAttached = false;\n\nfunction handleImportScopeKeydown(ev: KeyboardEvent): void {\n  if (ev.key === 'Escape') {\n    ev.preventDefault();\n    closeImportScopeModal();\n  }\n}\n\nfunction openImportScopeModal(opts: {\n  options: ImportContextOption[];\n  initialSelection: string[];\n  rememberInitially: boolean;\n  missingPreferred: string[];\n  onConfirm: (selected: string[], remember: boolean) => void;\n}): void {\n  if (!importScopeOverlay || !importScopeBody || !importScopeConfirmBtn || !importScopeCancelBtn) {\n    opts.onConfirm(opts.initialSelection, opts.rememberInitially);\n    return;\n  }\n\n  importScopeBody.innerHTML = '';\n\n  const grouped = new Map<string, ImportContextOption[]>();\n  for (let i = 0; i < opts.options.length; i++) {\n    const option = opts.options[i];\n    const list = grouped.get(option.collection) || [];\n    if (!grouped.has(option.collection)) grouped.set(option.collection, list);\n    list.push(option);\n  }\n\n  const collections = Array.from(grouped.keys()).sort((a, b) => (a < b ? -1 : a > b ? 1 : 0));\n  importScopeModalState = {\n    options: opts.options,\n    collections,\n    inputs: [],\n    inputsByCollection: new Map(),\n    onConfirm: opts.onConfirm\n  };\n\n  const initialSelectionsByCollection = new Map<string, string>();\n  for (let i = 0; i < opts.initialSelection.length; i++) {\n    const ctx = opts.initialSelection[i];\n    const match = opts.options.find(opt => opt.context === ctx);\n    if (match) initialSelectionsByCollection.set(match.collection, match.context);\n  }\n\n  for (let i = 0; i < collections.length; i++) {\n    const collection = collections[i];\n    const groupEl = document.createElement('div');\n    groupEl.className = 'import-scope-group';\n    const heading = document.createElement('h3');\n    heading.textContent = collection;\n    groupEl.appendChild(heading);\n\n    const modes = (grouped.get(collection) || []).sort((a, b) => (a.mode < b.mode ? -1 : a.mode > b.mode ? 1 : 0));\n    const defaultContext = initialSelectionsByCollection.get(collection) || modes[0]?.context || null;\n    const radioName = `importScopeMode_${i}`;\n    for (let j = 0; j < modes.length; j++) {\n      const opt = modes[j];\n      const label = document.createElement('label');\n      label.className = 'import-scope-mode';\n      const radio = document.createElement('input');\n      radio.type = 'radio';\n      radio.name = radioName;\n      radio.value = opt.context;\n      radio.checked = defaultContext === opt.context;\n      radio.addEventListener('change', updateImportScopeConfirmState);\n      importScopeModalState.inputs.push(radio);\n      const list = importScopeModalState.inputsByCollection.get(collection) || [];\n      if (!importScopeModalState.inputsByCollection.has(collection)) {\n        importScopeModalState.inputsByCollection.set(collection, list);\n      }\n      list.push(radio);\n\n      const span = document.createElement('span');\n      span.textContent = opt.mode;\n\n      label.appendChild(radio);\n      label.appendChild(span);\n      groupEl.appendChild(label);\n    }\n\n    importScopeBody.appendChild(groupEl);\n  }\n\n  if (importScopeRememberChk) importScopeRememberChk.checked = opts.rememberInitially;\n  if (importScopeMissingEl) {\n    if (opts.missingPreferred.length > 0) {\n      importScopeMissingEl.hidden = false;\n      importScopeMissingEl.textContent = 'Previously remembered modes not present in this file: ' + formatContextList(opts.missingPreferred);\n    } else {\n      importScopeMissingEl.hidden = true;\n      importScopeMissingEl.textContent = '';\n    }\n  }\n\n  updateImportScopeConfirmState();\n\n  importScopeOverlay.hidden = false;\n  importScopeOverlay.classList.add('is-open');\n  importScopeOverlay.setAttribute('aria-hidden', 'false');\n  if (!importScopeKeyListenerAttached) {\n    window.addEventListener('keydown', handleImportScopeKeydown, true);\n    importScopeKeyListenerAttached = true;\n  }\n  if (importScopeConfirmBtn) importScopeConfirmBtn.focus();\n}\n\nfunction closeImportScopeModal(): void {\n  if (!importScopeOverlay) return;\n  importScopeOverlay.classList.remove('is-open');\n  importScopeOverlay.hidden = true;\n  importScopeOverlay.setAttribute('aria-hidden', 'true');\n  if (importScopeKeyListenerAttached) {\n    window.removeEventListener('keydown', handleImportScopeKeydown, true);\n    importScopeKeyListenerAttached = false;\n  }\n  importScopeModalState = null;\n}\n\nfunction performImport(json: unknown, allowHex: boolean, contexts: string[]): void {\n  const normalized = normalizeContextList(contexts);\n  const payload: UiToPlugin = normalized.length > 0\n    ? { type: 'IMPORT_DTCG', payload: { json, allowHexStrings: allowHex, contexts: normalized } }\n    : { type: 'IMPORT_DTCG', payload: { json, allowHexStrings: allowHex } };\n  postToPlugin(payload);\n  lastImportSelection = normalized.slice();\n  const label = normalized.length > 0 ? formatContextList(normalized) : 'all contexts';\n  log(`Import requested (${label}).`);\n}\n\nfunction startImportFlow(json: unknown, allowHex: boolean): void {\n  const options = collectContextsFromJson(json);\n  if (options.length === 0) {\n    performImport(json, allowHex, []);\n    return;\n  }\n\n  const grouped = new Map<string, ImportContextOption[]>();\n  for (let i = 0; i < options.length; i++) {\n    const option = options[i];\n    const list = grouped.get(option.collection) || [];\n    if (!grouped.has(option.collection)) grouped.set(option.collection, list);\n    list.push(option);\n  }\n\n  const availableSet = new Set(options.map(opt => opt.context));\n  const missingPreferred: string[] = [];\n  let rememberInitially = false;\n  const initialSelectionsByCollection = new Map<string, string>();\n\n  if (importPreference && importPreference.contexts.length > 0) {\n    for (let i = 0; i < importPreference.contexts.length; i++) {\n      const ctx = importPreference.contexts[i];\n      if (availableSet.has(ctx)) {\n        const match = options.find(opt => opt.context === ctx);\n        if (match) {\n          initialSelectionsByCollection.set(match.collection, match.context);\n          rememberInitially = true;\n        }\n      } else {\n        missingPreferred.push(ctx);\n      }\n    }\n  }\n\n  const collections = Array.from(grouped.keys()).sort((a, b) => (a < b ? -1 : a > b ? 1 : 0));\n  for (let i = 0; i < collections.length; i++) {\n    const collection = collections[i];\n    if (!initialSelectionsByCollection.has(collection)) {\n      const modes = (grouped.get(collection) || []).sort((a, b) => (a.mode < b.mode ? -1 : a.mode > b.mode ? 1 : 0));\n      if (modes.length > 0) initialSelectionsByCollection.set(collection, modes[0].context);\n    }\n  }\n\n  const initialSelection = collections\n    .map(collection => initialSelectionsByCollection.get(collection))\n    .filter((ctx): ctx is string => typeof ctx === 'string');\n\n  const requiresChoice = collections.some(collection => {\n    const list = grouped.get(collection) || [];\n    return list.length > 1;\n  });\n\n  if (!requiresChoice) {\n    performImport(json, allowHex, initialSelection);\n    return;\n  }\n\n  openImportScopeModal({\n    options,\n    initialSelection,\n    rememberInitially,\n    missingPreferred,\n    onConfirm: (selected, remember) => {\n      if (remember) setImportPreference(selected);\n      else if (importPreference) clearImportPreference(true);\n      performImport(json, allowHex, selected);\n    }\n  });\n}\n\nfunction getPreferredImportContexts(): string[] {\n  if (importPreference && importPreference.contexts.length > 0) return importPreference.contexts.slice();\n  if (lastImportSelection.length > 0) return lastImportSelection.slice();\n  return [];\n}\n\nfunction postResize(width: number, height: number): void {\n  const w = Math.max(720, Math.min(1600, Math.floor(width)));\n  const h = Math.max(420, Math.min(1200, Math.floor(height)));\n  postToPlugin({ type: 'UI_RESIZE', payload: { width: w, height: h } });\n}\n\ntype ResizeTrackingState = {\n  pointerId: number;\n  startX: number;\n  startY: number;\n  startWidth: number;\n  startHeight: number;\n};\n\nlet resizeTracking: ResizeTrackingState | null = null;\nlet resizeQueued: { width: number; height: number } | null = null;\nlet resizeRaf = 0;\n\nfunction queueResize(width: number, height: number): void {\n  resizeQueued = { width, height };\n  if (resizeRaf !== 0) return;\n  resizeRaf = window.requestAnimationFrame(() => {\n    resizeRaf = 0;\n    if (!resizeQueued) return;\n    postResize(resizeQueued.width, resizeQueued.height);\n    resizeQueued = null;\n  });\n}\n\nfunction applyResizeDelta(ev: PointerEvent): void {\n  if (!resizeTracking || ev.pointerId !== resizeTracking.pointerId) return;\n  const dx = ev.clientX - resizeTracking.startX;\n  const dy = ev.clientY - resizeTracking.startY;\n  const nextW = resizeTracking.startWidth + dx;\n  const nextH = resizeTracking.startHeight + dy;\n  queueResize(nextW, nextH);\n  ev.preventDefault();\n}\n\nfunction endResize(ev: PointerEvent): void {\n  if (!resizeTracking || ev.pointerId !== resizeTracking.pointerId) return;\n  applyResizeDelta(ev);\n  window.removeEventListener('pointermove', handleResizeMove, true);\n  window.removeEventListener('pointerup', endResize, true);\n  window.removeEventListener('pointercancel', cancelResize, true);\n  if (resizeHandleEl) {\n    try { resizeHandleEl.releasePointerCapture(resizeTracking.pointerId); } catch { /* ignore */ }\n  }\n  resizeTracking = null;\n}\n\nfunction cancelResize(ev: PointerEvent): void {\n  if (!resizeTracking || ev.pointerId !== resizeTracking.pointerId) return;\n  window.removeEventListener('pointermove', handleResizeMove, true);\n  window.removeEventListener('pointerup', endResize, true);\n  window.removeEventListener('pointercancel', cancelResize, true);\n  if (resizeHandleEl) {\n    try { resizeHandleEl.releasePointerCapture(resizeTracking.pointerId); } catch { /* ignore */ }\n  }\n  resizeTracking = null;\n}\n\nfunction handleResizeMove(ev: PointerEvent): void {\n  applyResizeDelta(ev);\n}\n\nfunction autoFitOnce(): void {\n  if (typeof document === 'undefined') return;\n  const contentW = Math.max(\n    document.documentElement.scrollWidth,\n    document.body ? document.body.scrollWidth : 0\n  );\n  const contentH = Math.max(\n    document.documentElement.scrollHeight,\n    document.body ? document.body.scrollHeight : 0\n  );\n  const vw = window.innerWidth;\n  const vh = window.innerHeight;\n  const needsW = contentW > vw ? contentW : vw;\n  const needsH = contentH > vh ? contentH : vh;\n  if (needsW > vw || needsH > vh) postResize(needsW, needsH);\n}\n\n/* -------------------------------------------------------\n * Collections / logging\n * ----------------------------------------------------- */\nlet currentCollections: Array<{\n  id: string;\n  name: string;\n  modes: Array<{ id: string; name: string }>;\n  variables: Array<{ id: string; name: string; type: string }>;\n}> = [];\n\n/** Append a message to the log panel and console. */\nfunction log(msg: string): void {\n  const t = new Date().toLocaleTimeString();\n  const line = document.createElement('div');\n  line.textContent = '[' + t + '] ' + msg;\n  if (logEl) {\n    logEl.appendChild(line);\n    (logEl as HTMLElement).scrollTop = (logEl as HTMLElement).scrollHeight;\n  }\n}\n\n/** Send a typed message to the plugin controller. */\nfunction postToPlugin(message: UiToPlugin): void {\n  (parent as unknown as { postMessage: (m: unknown, t: string) => void })\n    .postMessage({ pluginMessage: message }, '*');\n}\n\nconst githubUi = createGithubUi({\n  postToPlugin: (message) => postToPlugin(message),\n  log: (message) => log(message),\n  getLogElement: () => logEl,\n  getCollectionSelect: () => collectionSelect,\n  getModeSelect: () => modeSelect,\n  getAllowHexCheckbox: () => allowHexChk,\n  getStyleDictionaryCheckbox: () => styleDictionaryChk,\n  getFlatTokensCheckbox: () => flatTokensChk,\n  getImportContexts: () => getPreferredImportContexts()\n});\n\n/** Remove every option from a select without replacing the node. */\nfunction clearSelect(sel: HTMLSelectElement): void {\n  while (sel.options.length > 0) sel.remove(0);\n}\n\n/** Update button/checkbox disabled states based on current selections. */\nfunction setDisabledStates(): void {\n  if (importBtn && fileInput) {\n    const hasFile = !!(fileInput.files && fileInput.files.length > 0);\n    importBtn.disabled = !hasFile;\n  }\n\n  if (exportBtn && exportAllChk && collectionSelect && modeSelect && exportPickers) {\n    const exportAll = !!exportAllChk.checked;\n    if (exportAll) {\n      exportBtn.disabled = false;\n      (exportPickers as HTMLElement).style.opacity = '0.5';\n    } else {\n      (exportPickers as HTMLElement).style.opacity = '1';\n      const hasSelection = !!collectionSelect.value && !!modeSelect.value;\n      exportBtn.disabled = !hasSelection;\n    }\n  }\n\n  if (exportTypographyBtn) {\n    exportTypographyBtn.disabled = false;\n  }\n}\n\n/** Render the collections/modes dropdowns from plugin-provided data. */\nfunction populateCollections(data: {\n  collections: Array<{\n    id: string; name: string;\n    modes: Array<{ id: string; name: string }>;\n    variables: Array<{ id: string; name: string; type: string }>;\n  }>;\n}): void {\n  currentCollections = data.collections;\n  if (!(collectionSelect && modeSelect)) return;\n\n  clearSelect(collectionSelect);\n  for (let i = 0; i < data.collections.length; i++) {\n    const c = data.collections[i];\n    const opt = document.createElement('option');\n    opt.value = c.name;\n    opt.textContent = c.name;\n    collectionSelect.appendChild(opt);\n  }\n  onCollectionChange();\n}\n\n/** Update mode selection and preview when the collection dropdown changes. */\nfunction onCollectionChange(): void {\n  if (!(collectionSelect && modeSelect)) return;\n\n  const selected = collectionSelect.value;\n  clearSelect(modeSelect);\n\n  let firstModeSet = false;\n  for (let i = 0; i < currentCollections.length; i++) {\n    const c = currentCollections[i];\n    if (c.name === selected) {\n      for (let j = 0; j < c.modes.length; j++) {\n        const m = c.modes[j];\n        const opt = document.createElement('option');\n        opt.value = m.name;\n        opt.textContent = m.name;\n        modeSelect.appendChild(opt);\n      }\n      // ensure a default mode is selected for enablement logic\n      if (modeSelect.options.length > 0 && modeSelect.selectedIndex === -1) {\n        modeSelect.selectedIndex = 0;\n        firstModeSet = true;\n      }\n      break;\n    }\n  }\n\n  setDisabledStates();\n  githubUi.onSelectionChange();\n\n  // If we auto-set a mode (firstModeSet), update the preview as well\n  if (firstModeSet) requestPreviewForCurrent();\n}\n\n\n/** Restore the most recently used collection/mode pair. */\nfunction applyLastSelection(last: { collection: string; mode: string } | null): void {\n  if (!last || !(collectionSelect && modeSelect)) return;\n\n  let found = false;\n  for (let i = 0; i < collectionSelect.options.length; i++) {\n    if (collectionSelect.options[i].value === last.collection) {\n      collectionSelect.selectedIndex = i;\n      found = true;\n      break;\n    }\n  }\n\n  onCollectionChange();\n\n  if (found) {\n    for (let j = 0; j < modeSelect.options.length; j++) {\n      if (modeSelect.options[j].value === last.mode) {\n        modeSelect.selectedIndex = j;\n        break;\n      }\n    }\n  }\n\n  setDisabledStates();\n}\n\n/** Format JSON with indentation while collapsing undefined/null gracefully. */\nfunction prettyJson(obj: unknown): string {\n  try { return JSON.stringify(obj, null, 2); } catch { return String(obj); }\n}\n\n/** Ask the plugin for a preview of the currently selected token scope. */\nfunction requestPreviewForCurrent(): void {\n  if (!(collectionSelect && modeSelect)) return;\n  const collection = collectionSelect.value || '';\n  const mode = modeSelect.value || '';\n  if (!collection || !mode) {\n    if (w3cPreviewEl) w3cPreviewEl.textContent = '{ /* select a collection & mode to preview */ }';\n    return;\n  }\n  const styleDictionary = !!(styleDictionaryChk && styleDictionaryChk.checked);\n  const flatTokens = !!(flatTokensChk && flatTokensChk.checked);\n  postToPlugin({\n    type: 'PREVIEW_REQUEST',\n    payload: { collection, mode, styleDictionary, flatTokens }\n  });\n}\n\n/* -------------------------------------------------------\n * GitHub: Branch helpers (Variant 4)\n * ----------------------------------------------------- */\n/** Toggle the branch select and associated placeholders. */\n\n\n/* -------------------------------------------------------\n * Message pump\n * ----------------------------------------------------- */\nwindow.addEventListener('message', async (event: MessageEvent) => {\n  const data: unknown = (event as unknown as { data?: unknown }).data;\n  if (!data || typeof data !== 'object') return;\n\n  let msg: PluginToUi | any | null = null;\n  if ((data as any).pluginMessage && typeof (data as any).pluginMessage === 'object') {\n    const maybe = (data as any).pluginMessage;\n    if (maybe && typeof maybe.type === 'string') msg = maybe;\n  }\n  if (!msg) return;\n\n  // Keep generic INFO/ERROR logs visible\n  if (msg.type === 'ERROR') { log('ERROR: ' + (msg.payload?.message ?? '')); return; }\n  if (msg.type === 'INFO') { log(msg.payload?.message ?? ''); return; }\n\n  if (msg.type === 'IMPORT_SUMMARY') {\n    const summary = msg.payload.summary;\n    if (summary && Array.isArray(summary.appliedContexts)) {\n      lastImportSelection = summary.appliedContexts.slice();\n    } else {\n      lastImportSelection = [];\n    }\n    addImportLogEntry({ timestamp: msg.payload.timestamp, source: msg.payload.source, summary });\n    renderImportPreferenceSummary();\n    return;\n  }\n\n  if (githubUi.handleMessage(msg)) return;\n\n    if (msg.type === 'EXPORT_RESULT') {\n    const files = Array.isArray(msg.payload?.files) ? msg.payload.files : [];\n    if (files.length === 0) { log('Nothing to export.'); return; }\n\n    if (pendingSave && files.length === 1) {\n      const only = files[0];\n      const fname = prettyExportName(only?.name);\n      const text = prettyJson(only?.json);\n\n      const ok = await finishPendingSave(text);\n      if (ok) {\n        log('Saved ' + fname + ' via file picker.');\n        const div = document.createElement('div');\n        const link = document.createElement('a');\n        link.href = '#';\n        link.textContent = 'Download ' + fname + ' again';\n        link.addEventListener('click', (e) => { e.preventDefault(); triggerJsonDownload(fname, text); });\n        if (logEl) {\n          div.appendChild(link);\n          logEl.appendChild(div);\n          (logEl as HTMLElement).scrollTop = (logEl as HTMLElement).scrollHeight;\n        }\n        log('Export ready.');\n        return;\n      }\n      log('Could not write via file picker; falling back to download links.');\n    }\n\n    setDrawerOpen(true);\n    for (let k = 0; k < files.length; k++) {\n      const f = files[k];\n      const fname = prettyExportName(f?.name);\n      const text = prettyJson(f?.json);\n      triggerJsonDownload(fname, text);\n\n      const div = document.createElement('div');\n      const link = document.createElement('a');\n      link.href = '#';\n      link.textContent = 'Download ' + fname;\n      link.addEventListener('click', (e) => { e.preventDefault(); triggerJsonDownload(fname, text); });\n      if (logEl) {\n        div.appendChild(link);\n        logEl.appendChild(div);\n        (logEl as HTMLElement).scrollTop = (logEl as HTMLElement).scrollHeight;\n      }\n    }\n    log('Export ready.');\n    return;\n  }\n\n  if (msg.type === 'W3C_PREVIEW') {\n    const displayName = prettyExportName(msg.payload.name);\n    const header = `/* ${displayName} */\\n`;\n    if (w3cPreviewEl) w3cPreviewEl.textContent = header + prettyJson(msg.payload.json);\n    return;\n  }\n\n  if (msg.type === 'COLLECTIONS_DATA') {\n    populateCollections({ collections: msg.payload.collections });\n    if (exportAllChk) exportAllChk.checked = !!msg.payload.exportAllPref;\n    if (styleDictionaryChk && typeof msg.payload.styleDictionaryPref === 'boolean') {\n      styleDictionaryChk.checked = !!msg.payload.styleDictionaryPref;\n    }\n    if (flatTokensChk && typeof msg.payload.flatTokensPref === 'boolean') {\n      flatTokensChk.checked = !!msg.payload.flatTokensPref;\n    }\n    const last = (msg.payload as any).last as { collection: string; mode: string } | null;\n    applyLastSelection(last);\n    setDisabledStates();\n    requestPreviewForCurrent();\n    return;\n  }\n\n  if (msg.type === 'RAW_COLLECTIONS_TEXT') {\n    if (rawEl) rawEl.textContent = msg.payload.text;\n    return;\n  }\n\n});\n\n/* -------------------------------------------------------\n * DOM wiring (runs when document exists)\n * ----------------------------------------------------- */\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  if (typeof document === 'undefined') return;\n\n  logEl = document.getElementById('log');\n  rawEl = document.getElementById('raw');\n\n  exportAllChk = document.getElementById('exportAllChk') as HTMLInputElement | null;\n  collectionSelect = document.getElementById('collectionSelect') as HTMLSelectElement | null;\n  modeSelect = document.getElementById('modeSelect') as HTMLSelectElement | null;\n\n  fileInput = document.getElementById('file') as HTMLInputElement | null;\n  importBtn = document.getElementById('importBtn') as HTMLButtonElement | null;\n  exportBtn = document.getElementById('exportBtn') as HTMLButtonElement | null;\n  exportTypographyBtn = document.getElementById('exportTypographyBtn') as HTMLButtonElement | null;\n  exportPickers = document.getElementById('exportPickers');\n\n  refreshBtn = document.getElementById('refreshBtn') as HTMLButtonElement | null;\n\n  shellEl = document.querySelector('.shell') as HTMLElement | null;\n  drawerToggleBtn = document.getElementById('drawerToggleBtn') as HTMLButtonElement | null;\n  resizeHandleEl = document.getElementById('resizeHandle');\n\n  w3cPreviewEl = document.getElementById('w3cPreview') as HTMLElement | null;\n\n  copyRawBtn = document.getElementById('copyRawBtn') as HTMLButtonElement | null;\n  copyW3cBtn = document.getElementById('copyW3cBtn') as HTMLButtonElement | null;\n  copyLogBtn = document.getElementById('copyLogBtn') as HTMLButtonElement | null;\n\n  allowHexChk = document.getElementById('allowHexChk') as HTMLInputElement | null;\n  styleDictionaryChk = document.getElementById('styleDictionaryChk') as HTMLInputElement | null;\n  flatTokensChk = document.getElementById('flatTokensChk') as HTMLInputElement | null;\n\n  importScopeOverlay = document.getElementById('importScopeOverlay');\n  importScopeBody = document.getElementById('importScopeBody');\n  importScopeConfirmBtn = document.getElementById('importScopeConfirmBtn') as HTMLButtonElement | null;\n  importScopeCancelBtn = document.getElementById('importScopeCancelBtn') as HTMLButtonElement | null;\n  importScopeRememberChk = document.getElementById('importScopeRememberChk') as HTMLInputElement | null;\n  importScopeMissingEl = document.getElementById('importScopeMissingNotice');\n\n  importScopeSummaryEl = document.getElementById('importScopeSummary');\n  importScopeSummaryTextEl = document.getElementById('importScopeSummaryText');\n  importScopeClearBtn = document.getElementById('importScopeClearBtn') as HTMLButtonElement | null;\n\n  importSkipLogListEl = document.getElementById('importSkipLogList');\n  importSkipLogEmptyEl = document.getElementById('importSkipLogEmpty');\n\n  loadImportPreference();\n  loadImportLog();\n  renderImportPreferenceSummary();\n  renderImportLog();\n\n  if (importScopeClearBtn) {\n    importScopeClearBtn.addEventListener('click', () => clearImportPreference(true));\n  }\n\n  if (importScopeConfirmBtn) {\n    importScopeConfirmBtn.addEventListener('click', () => {\n      if (!importScopeModalState) { closeImportScopeModal(); return; }\n      const state = importScopeModalState;\n      const selections: string[] = [];\n      for (let i = 0; i < state.collections.length; i++) {\n        const collection = state.collections[i];\n        const inputs = state.inputsByCollection.get(collection) || [];\n        const selected = inputs.find(input => input.checked);\n        if (!selected) return;\n        selections.push(selected.value);\n      }\n      const remember = importScopeRememberChk ? !!importScopeRememberChk.checked : false;\n      closeImportScopeModal();\n      state.onConfirm(selections, remember);\n    });\n  }\n\n  if (importScopeCancelBtn) {\n    importScopeCancelBtn.addEventListener('click', () => closeImportScopeModal());\n  }\n\n  if (importScopeOverlay) {\n    importScopeOverlay.addEventListener('click', (ev) => {\n      if (ev.target === importScopeOverlay) closeImportScopeModal();\n    });\n  }\n\n  if (resizeHandleEl) {\n    resizeHandleEl.addEventListener('pointerdown', (event: PointerEvent) => {\n      if (event.button !== 0 && event.pointerType === 'mouse') return;\n      if (resizeTracking) return;\n      event.preventDefault();\n      resizeTracking = {\n        pointerId: event.pointerId,\n        startX: event.clientX,\n        startY: event.clientY,\n        startWidth: window.innerWidth,\n        startHeight: window.innerHeight\n      };\n      try { resizeHandleEl!.setPointerCapture(event.pointerId); } catch { /* ignore */ }\n      window.addEventListener('pointermove', handleResizeMove, true);\n      window.addEventListener('pointerup', endResize, true);\n      window.addEventListener('pointercancel', cancelResize, true);\n    });\n  }\n\n  githubUi.attach({ document, window });\n\n  if (fileInput) fileInput.addEventListener('change', setDisabledStates);\n\n  if (exportAllChk) {\n    exportAllChk.addEventListener('change', () => {\n      setDisabledStates();\n      postToPlugin({ type: 'SAVE_PREFS', payload: { exportAll: !!exportAllChk!.checked } });\n      githubUi.onSelectionChange();\n    });\n  }\n\n  if (styleDictionaryChk) {\n    styleDictionaryChk.addEventListener('change', () => {\n      postToPlugin({ type: 'SAVE_PREFS', payload: { styleDictionary: !!styleDictionaryChk!.checked } });\n      requestPreviewForCurrent();\n      githubUi.onSelectionChange();\n    });\n  }\n\n  if (flatTokensChk) {\n    flatTokensChk.addEventListener('change', () => {\n      postToPlugin({ type: 'SAVE_PREFS', payload: { flatTokens: !!flatTokensChk!.checked } });\n      requestPreviewForCurrent();\n      githubUi.onSelectionChange();\n    });\n  }\n\n  if (refreshBtn) {\n    refreshBtn.addEventListener('click', () => {\n      postToPlugin({ type: 'FETCH_COLLECTIONS' });\n    });\n  }\n\n  if (importBtn && fileInput) {\n    importBtn.addEventListener('click', () => {\n      if (!fileInput!.files || fileInput!.files.length === 0) { log('Select a JSON file first.'); return; }\n      const reader = new FileReader();\n      reader.onload = function () {\n        try {\n          const text = String(reader.result);\n          const json = JSON.parse(text);\n          if (!json || typeof json !== 'object' || (json instanceof Array)) {\n            log('Invalid JSON structure for tokens (expected an object).');\n            return;\n          }\n          const allowHex = !!(allowHexChk && allowHexChk.checked);\n          startImportFlow(json, allowHex);\n        } catch (e) {\n          const msg = e instanceof Error ? e.message : String(e);\n          log('Failed to parse JSON: ' + msg);\n        }\n      };\n      reader.readAsText(fileInput!.files[0]);\n    });\n  }\n\n  if (exportBtn) {\n    exportBtn.addEventListener('click', async () => {\n      let exportAll = false;\n      if (exportAllChk) exportAll = !!exportAllChk.checked;\n\n      const styleDictionary = !!(styleDictionaryChk && styleDictionaryChk.checked);\n      const flatTokens = !!(flatTokensChk && flatTokensChk.checked);\n\n      const payload: {\n        exportAll: boolean;\n        collection?: string;\n        mode?: string;\n        styleDictionary?: boolean;\n        flatTokens?: boolean;\n      } = { exportAll, styleDictionary, flatTokens };\n      if (!exportAll && collectionSelect && modeSelect) {\n        payload.collection = collectionSelect.value;\n        payload.mode = modeSelect.value;\n        if (!(payload.collection && payload.mode)) { log('Pick collection and mode or use \"Export all\".'); return; }\n      }\n\n      const suggestedName = exportAll\n        ? 'tokens.json'\n        : prettyExportName(`${payload.collection ?? 'Tokens'}_mode=${payload.mode ?? 'Mode 1'}.tokens.json`);\n\n      await beginPendingSave(suggestedName);\n\n      postToPlugin({ type: 'EXPORT_DTCG', payload });\n      if (exportAll) log('Export all requested.');\n      else log(`Export requested for \"${payload.collection || ''}\" / \"${payload.mode || ''}\".`);\n    });\n  }\n\n  if (exportTypographyBtn) {\n    exportTypographyBtn.addEventListener('click', async () => {\n      await beginPendingSave('typography.json');\n      postToPlugin({ type: 'EXPORT_TYPOGRAPHY' });\n      log('Typography export requested.');\n    });\n  }\n\n  if (drawerToggleBtn) {\n    drawerToggleBtn.addEventListener('click', () => {\n      const current = drawerToggleBtn!.getAttribute('aria-expanded') === 'true';\n      setDrawerOpen(!current);\n    });\n  }\n\n  if (collectionSelect) {\n    collectionSelect.addEventListener('change', () => {\n      onCollectionChange();\n      if (collectionSelect && modeSelect) {\n        postToPlugin({ type: 'SAVE_LAST', payload: { collection: collectionSelect.value, mode: modeSelect.value } });\n        requestPreviewForCurrent();\n      }\n      githubUi.onSelectionChange();\n    });\n  }\n\n  if (modeSelect) {\n    modeSelect.addEventListener('change', () => {\n      if (collectionSelect && modeSelect) {\n        postToPlugin({ type: 'SAVE_LAST', payload: { collection: collectionSelect.value, mode: modeSelect.value } });\n      }\n      setDisabledStates();\n      requestPreviewForCurrent();\n      githubUi.onSelectionChange();\n    });\n  }\n\n  if (copyRawBtn) copyRawBtn.addEventListener('click', () =>\n    copyElText(document.getElementById('raw') as HTMLElement, 'Raw Figma Collections')\n  );\n  if (copyW3cBtn) copyW3cBtn.addEventListener('click', () =>\n    copyElText(document.getElementById('w3cPreview') as HTMLElement, 'W3C Preview')\n  );\n  if (copyLogBtn) copyLogBtn.addEventListener('click', () =>\n    copyElText(document.getElementById('log') as HTMLElement, 'Log')\n  );\n\n  githubUi.onSelectionChange();\n  autoFitOnce();\n\n  if (rawEl) rawEl.textContent = 'Loading variable collections\u2026';\n  setDisabledStates();\n  setDrawerOpen(getSavedDrawerOpen());\n  postToPlugin({ type: 'UI_READY' });\n});\n\n/* -------------------------------------------------------\n * Drawer helpers\n * ----------------------------------------------------- */\n/** Persist drawer state and adjust CSS hooks so the UI animates correctly. */\nfunction setDrawerOpen(open: boolean): void {\n  if (shellEl) {\n    if (open) shellEl.classList.remove('drawer-collapsed');\n    else shellEl.classList.add('drawer-collapsed');\n  }\n  if (drawerToggleBtn) {\n    drawerToggleBtn.setAttribute('aria-expanded', open ? 'true' : 'false');\n    drawerToggleBtn.textContent = open ? 'Hide' : 'Show';\n    drawerToggleBtn.title = open ? 'Hide log' : 'Show log';\n  }\n  try { window.localStorage.setItem('drawerOpen', open ? '1' : '0'); } catch { /* ignore */ }\n}\n\n/** Load the saved drawer state flag from local storage. */\nfunction getSavedDrawerOpen(): boolean {\n  try {\n    const v = window.localStorage.getItem('drawerOpen');\n    if (v === '0') return false;\n    if (v === '1') return true;\n  } catch { /* ignore */ }\n  return true;\n}\n"],
  "mappings": "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",
  "names": ["clearSelect", "collectionSelect", "modeSelect", "logEl", "e"]
}
