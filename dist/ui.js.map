{
  "version": 3,
  "sources": ["../src/app/ui.ts"],
  "sourcesContent": ["import type { PluginToUi, UiToPlugin } from './messages';\n\nvar logEl = document.getElementById('log') as HTMLElement;\nvar rawEl = document.getElementById('raw') as HTMLElement;\n\nvar exportAllChk = document.getElementById('exportAllChk') as HTMLInputElement | null;\nvar collectionSelect = document.getElementById('collectionSelect') as HTMLSelectElement | null;\nvar modeSelect = document.getElementById('modeSelect') as HTMLSelectElement | null;\n\nvar fileInput = document.getElementById('file') as HTMLInputElement | null;\nvar importBtn = document.getElementById('importBtn') as HTMLButtonElement | null;\nvar exportBtn = document.getElementById('exportBtn') as HTMLButtonElement | null;\nvar exportPickers = document.getElementById('exportPickers') as HTMLElement | null;\nvar refreshBtn = document.getElementById('refreshBtn') as HTMLButtonElement | null;\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  (parent as any).postMessage({ pluginMessage: { type: 'UI_READY' } }, '*');\n});\n\nfunction log(msg: string) {\n  var t = new Date().toLocaleTimeString();\n  var line = document.createElement('div');\n  line.textContent = '[' + t + '] ' + msg;\n  logEl.appendChild(line);\n  logEl.scrollTop = logEl.scrollHeight;\n}\n\nfunction postToPlugin(message: UiToPlugin) {\n  (parent as any).postMessage({ pluginMessage: message }, '*');\n}\n\nfunction clearSelect(sel: HTMLSelectElement) { while (sel.options.length > 0) sel.remove(0); }\n\nfunction setDisabledStates() {\n  if (importBtn && fileInput) {\n    var hasFile = !!(fileInput.files && fileInput.files.length > 0);\n    importBtn.disabled = !hasFile;\n  }\n  if (exportBtn && exportAllChk && collectionSelect && modeSelect && exportPickers) {\n    var exportAll = !!exportAllChk.checked;\n    if (exportAll) {\n      exportBtn.disabled = false;\n      exportPickers.style.opacity = '0.5';\n    } else {\n      exportPickers.style.opacity = '1';\n      var hasSelection = collectionSelect.value.length > 0 && modeSelect.value.length > 0;\n      exportBtn.disabled = !hasSelection;\n    }\n  }\n}\n\nfunction populateCollections(data: { collections: Array<{ id: string; name: string; modes: Array<{ id: string; name: string }> }> }) {\n  if (!collectionSelect || !modeSelect) return;\n  clearSelect(collectionSelect);\n  var i: number;\n  for (i = 0; i < data.collections.length; i++) {\n    var c = data.collections[i];\n    var opt = document.createElement('option');\n    opt.value = c.name;\n    opt.textContent = c.name;\n    collectionSelect.appendChild(opt);\n  }\n  onCollectionChange(data);\n}\n\nfunction onCollectionChange(data: { collections: Array<{ id: string; name: string; modes: Array<{ id: string; name: string }> }> }) {\n  if (!collectionSelect || !modeSelect) return;\n  var selected = collectionSelect.value;\n  clearSelect(modeSelect);\n  var i: number;\n  for (i = 0; i < data.collections.length; i++) {\n    var c = data.collections[i];\n    if (c.name === selected) {\n      var j: number;\n      for (j = 0; j < c.modes.length; j++) {\n        var m = c.modes[j];\n        var opt = document.createElement('option');\n        opt.value = m.name;\n        opt.textContent = m.name;\n        modeSelect.appendChild(opt);\n      }\n      break;\n    }\n  }\n  setDisabledStates();\n}\n\nfunction prettyJson(obj: any) { try { return JSON.stringify(obj, null, 2); } catch (_e) { return String(obj); } }\n\n/* ---------- Events ---------- */\nif (collectionSelect) collectionSelect.addEventListener('change', function () { postToPlugin({ type: 'FETCH_COLLECTIONS' }); });\nif (modeSelect) modeSelect.addEventListener('change', setDisabledStates);\nif (fileInput) fileInput.addEventListener('change', setDisabledStates);\nif (exportAllChk) exportAllChk.addEventListener('change', setDisabledStates);\nif (refreshBtn) refreshBtn.addEventListener('click', function () { postToPlugin({ type: 'FETCH_COLLECTIONS' }); });\n\n/* Import button (closure-safe narrowing) */\n(function () {\n  var importBtnEl = document.getElementById('importBtn');\n  var fileInputEl0 = document.getElementById('file');\n  if (importBtnEl instanceof HTMLButtonElement && fileInputEl0 instanceof HTMLInputElement) {\n    const button: HTMLButtonElement = importBtnEl;\n    const input: HTMLInputElement = fileInputEl0;\n\n    button.addEventListener('click', function () {\n      if (!input.files || input.files.length === 0) {\n        log('Select a JSON file first.');\n        return;\n      }\n      var reader = new FileReader();\n      reader.onload = function () {\n        try {\n          var text = String(reader.result);\n          var json = JSON.parse(text);\n          postToPlugin({ type: 'IMPORT_DTCG', payload: { json: json } });\n          log('Import requested.');\n        } catch (e) {\n          var msg = (e instanceof Error) ? e.message : String(e);\n          log('Failed to parse JSON: ' + msg);\n        }\n      };\n      reader.readAsText(input.files[0]);\n    });\n  }\n})();\n\n/* Export button */\n(function () {\n  var exportBtnEl = document.getElementById('exportBtn');\n  var exportAllEl = document.getElementById('exportAllChk');\n  var collSelEl = document.getElementById('collectionSelect');\n  var modeSelEl = document.getElementById('modeSelect');\n\n  if (exportBtnEl instanceof HTMLButtonElement) {\n    exportBtnEl.addEventListener('click', function () {\n      var exportAll = !!(exportAllEl instanceof HTMLInputElement && exportAllEl.checked);\n      var payload: { exportAll: boolean; collection?: string; mode?: string } = { exportAll: exportAll };\n      if (!exportAll && collSelEl instanceof HTMLSelectElement && modeSelEl instanceof HTMLSelectElement) {\n        payload.collection = collSelEl.value;\n        payload.mode = modeSelEl.value;\n        if (!(payload.collection && payload.mode)) { log('Pick collection and mode or use \"Export all\".'); return; }\n      }\n      postToPlugin({ type: 'EXPORT_DTCG', payload: payload });\n      if (exportAll) log('Export all requested.');\n      else log('Export requested for \"' + payload.collection + '\" / \"' + payload.mode + '\".');\n    });\n  }\n})();\n\n/* ---------- Receive from plugin ---------- */\n(window as any).onmessage = function (event: MessageEvent<{ pluginMessage?: PluginToUi }>) {\n  var msg = event.data && event.data.pluginMessage ? event.data.pluginMessage : null;\n  if (!msg) return;\n\n  if (msg.type === 'ERROR') { log('ERROR: ' + msg.payload.message); return; }\n  if (msg.type === 'INFO') { log(msg.payload.message); return; }\n\n  if (msg.type === 'EXPORT_RESULT') {\n    var k: number;\n    for (k = 0; k < msg.payload.files.length; k++) {\n      var f = msg.payload.files[k];\n      var a = document.createElement('a');\n      var blob = new Blob([prettyJson(f.json)], { type: 'application/json' });\n      a.href = URL.createObjectURL(blob);\n      a.download = f.name;\n      a.textContent = 'Download ' + f.name;\n      var div = document.createElement('div');\n      div.appendChild(a);\n      logEl.appendChild(div);\n    }\n    log('Export ready.');\n    return;\n  }\n\n  if (msg.type === 'COLLECTIONS_DATA') {\n    populateCollections({ collections: msg.payload.collections });\n    setDisabledStates();\n    return;\n  }\n\n  if (msg.type === 'RAW_COLLECTIONS_TEXT') {\n    rawEl.textContent = msg.payload.text;\n    return;\n  }\n};\n\n/* ---------- Announce ready ---------- */\nrawEl.textContent = 'Loading variable collections\u2026';\nsetDisabledStates();\npostToPlugin({ type: 'UI_READY' });\n"],
  "mappings": ";;;AAEA,MAAI,QAAQ,SAAS,eAAe,KAAK;AACzC,MAAI,QAAQ,SAAS,eAAe,KAAK;AAEzC,MAAI,eAAe,SAAS,eAAe,cAAc;AACzD,MAAI,mBAAmB,SAAS,eAAe,kBAAkB;AACjE,MAAI,aAAa,SAAS,eAAe,YAAY;AAErD,MAAI,YAAY,SAAS,eAAe,MAAM;AAC9C,MAAI,YAAY,SAAS,eAAe,WAAW;AACnD,MAAI,YAAY,SAAS,eAAe,WAAW;AACnD,MAAI,gBAAgB,SAAS,eAAe,eAAe;AAC3D,MAAI,aAAa,SAAS,eAAe,YAAY;AAErD,WAAS,iBAAiB,oBAAoB,WAAY;AACxD,IAAC,OAAe,YAAY,EAAE,eAAe,EAAE,MAAM,WAAW,EAAE,GAAG,GAAG;AAAA,EAC1E,CAAC;AAED,WAAS,IAAI,KAAa;AACxB,QAAI,KAAI,oBAAI,KAAK,GAAE,mBAAmB;AACtC,QAAI,OAAO,SAAS,cAAc,KAAK;AACvC,SAAK,cAAc,MAAM,IAAI,OAAO;AACpC,UAAM,YAAY,IAAI;AACtB,UAAM,YAAY,MAAM;AAAA,EAC1B;AAEA,WAAS,aAAa,SAAqB;AACzC,IAAC,OAAe,YAAY,EAAE,eAAe,QAAQ,GAAG,GAAG;AAAA,EAC7D;AAEA,WAAS,YAAY,KAAwB;AAAE,WAAO,IAAI,QAAQ,SAAS,EAAG,KAAI,OAAO,CAAC;AAAA,EAAG;AAE7F,WAAS,oBAAoB;AAC3B,QAAI,aAAa,WAAW;AAC1B,UAAI,UAAU,CAAC,EAAE,UAAU,SAAS,UAAU,MAAM,SAAS;AAC7D,gBAAU,WAAW,CAAC;AAAA,IACxB;AACA,QAAI,aAAa,gBAAgB,oBAAoB,cAAc,eAAe;AAChF,UAAI,YAAY,CAAC,CAAC,aAAa;AAC/B,UAAI,WAAW;AACb,kBAAU,WAAW;AACrB,sBAAc,MAAM,UAAU;AAAA,MAChC,OAAO;AACL,sBAAc,MAAM,UAAU;AAC9B,YAAI,eAAe,iBAAiB,MAAM,SAAS,KAAK,WAAW,MAAM,SAAS;AAClF,kBAAU,WAAW,CAAC;AAAA,MACxB;AAAA,IACF;AAAA,EACF;AAEA,WAAS,oBAAoB,MAAwG;AACnI,QAAI,CAAC,oBAAoB,CAAC,WAAY;AACtC,gBAAY,gBAAgB;AAC5B,QAAI;AACJ,SAAK,IAAI,GAAG,IAAI,KAAK,YAAY,QAAQ,KAAK;AAC5C,UAAI,IAAI,KAAK,YAAY,CAAC;AAC1B,UAAI,MAAM,SAAS,cAAc,QAAQ;AACzC,UAAI,QAAQ,EAAE;AACd,UAAI,cAAc,EAAE;AACpB,uBAAiB,YAAY,GAAG;AAAA,IAClC;AACA,uBAAmB,IAAI;AAAA,EACzB;AAEA,WAAS,mBAAmB,MAAwG;AAClI,QAAI,CAAC,oBAAoB,CAAC,WAAY;AACtC,QAAI,WAAW,iBAAiB;AAChC,gBAAY,UAAU;AACtB,QAAI;AACJ,SAAK,IAAI,GAAG,IAAI,KAAK,YAAY,QAAQ,KAAK;AAC5C,UAAI,IAAI,KAAK,YAAY,CAAC;AAC1B,UAAI,EAAE,SAAS,UAAU;AACvB,YAAI;AACJ,aAAK,IAAI,GAAG,IAAI,EAAE,MAAM,QAAQ,KAAK;AACnC,cAAI,IAAI,EAAE,MAAM,CAAC;AACjB,cAAI,MAAM,SAAS,cAAc,QAAQ;AACzC,cAAI,QAAQ,EAAE;AACd,cAAI,cAAc,EAAE;AACpB,qBAAW,YAAY,GAAG;AAAA,QAC5B;AACA;AAAA,MACF;AAAA,IACF;AACA,sBAAkB;AAAA,EACpB;AAEA,WAAS,WAAW,KAAU;AAAE,QAAI;AAAE,aAAO,KAAK,UAAU,KAAK,MAAM,CAAC;AAAA,IAAG,SAAS,IAAI;AAAE,aAAO,OAAO,GAAG;AAAA,IAAG;AAAA,EAAE;AAGhH,MAAI,iBAAkB,kBAAiB,iBAAiB,UAAU,WAAY;AAAE,iBAAa,EAAE,MAAM,oBAAoB,CAAC;AAAA,EAAG,CAAC;AAC9H,MAAI,WAAY,YAAW,iBAAiB,UAAU,iBAAiB;AACvE,MAAI,UAAW,WAAU,iBAAiB,UAAU,iBAAiB;AACrE,MAAI,aAAc,cAAa,iBAAiB,UAAU,iBAAiB;AAC3E,MAAI,WAAY,YAAW,iBAAiB,SAAS,WAAY;AAAE,iBAAa,EAAE,MAAM,oBAAoB,CAAC;AAAA,EAAG,CAAC;AAGjH,GAAC,WAAY;AACX,QAAI,cAAc,SAAS,eAAe,WAAW;AACrD,QAAI,eAAe,SAAS,eAAe,MAAM;AACjD,QAAI,uBAAuB,qBAAqB,wBAAwB,kBAAkB;AACxF,YAAM,SAA4B;AAClC,YAAM,QAA0B;AAEhC,aAAO,iBAAiB,SAAS,WAAY;AAC3C,YAAI,CAAC,MAAM,SAAS,MAAM,MAAM,WAAW,GAAG;AAC5C,cAAI,2BAA2B;AAC/B;AAAA,QACF;AACA,YAAI,SAAS,IAAI,WAAW;AAC5B,eAAO,SAAS,WAAY;AAC1B,cAAI;AACF,gBAAI,OAAO,OAAO,OAAO,MAAM;AAC/B,gBAAI,OAAO,KAAK,MAAM,IAAI;AAC1B,yBAAa,EAAE,MAAM,eAAe,SAAS,EAAE,KAAW,EAAE,CAAC;AAC7D,gBAAI,mBAAmB;AAAA,UACzB,SAAS,GAAG;AACV,gBAAI,MAAO,aAAa,QAAS,EAAE,UAAU,OAAO,CAAC;AACrD,gBAAI,2BAA2B,GAAG;AAAA,UACpC;AAAA,QACF;AACA,eAAO,WAAW,MAAM,MAAM,CAAC,CAAC;AAAA,MAClC,CAAC;AAAA,IACH;AAAA,EACF,GAAG;AAGH,GAAC,WAAY;AACX,QAAI,cAAc,SAAS,eAAe,WAAW;AACrD,QAAI,cAAc,SAAS,eAAe,cAAc;AACxD,QAAI,YAAY,SAAS,eAAe,kBAAkB;AAC1D,QAAI,YAAY,SAAS,eAAe,YAAY;AAEpD,QAAI,uBAAuB,mBAAmB;AAC5C,kBAAY,iBAAiB,SAAS,WAAY;AAChD,YAAI,YAAY,CAAC,EAAE,uBAAuB,oBAAoB,YAAY;AAC1E,YAAI,UAAsE,EAAE,UAAqB;AACjG,YAAI,CAAC,aAAa,qBAAqB,qBAAqB,qBAAqB,mBAAmB;AAClG,kBAAQ,aAAa,UAAU;AAC/B,kBAAQ,OAAO,UAAU;AACzB,cAAI,EAAE,QAAQ,cAAc,QAAQ,OAAO;AAAE,gBAAI,+CAA+C;AAAG;AAAA,UAAQ;AAAA,QAC7G;AACA,qBAAa,EAAE,MAAM,eAAe,QAAiB,CAAC;AACtD,YAAI,UAAW,KAAI,uBAAuB;AAAA,YACrC,KAAI,2BAA2B,QAAQ,aAAa,UAAU,QAAQ,OAAO,IAAI;AAAA,MACxF,CAAC;AAAA,IACH;AAAA,EACF,GAAG;AAGH,EAAC,OAAe,YAAY,SAAU,OAAqD;AACzF,QAAI,MAAM,MAAM,QAAQ,MAAM,KAAK,gBAAgB,MAAM,KAAK,gBAAgB;AAC9E,QAAI,CAAC,IAAK;AAEV,QAAI,IAAI,SAAS,SAAS;AAAE,UAAI,YAAY,IAAI,QAAQ,OAAO;AAAG;AAAA,IAAQ;AAC1E,QAAI,IAAI,SAAS,QAAQ;AAAE,UAAI,IAAI,QAAQ,OAAO;AAAG;AAAA,IAAQ;AAE7D,QAAI,IAAI,SAAS,iBAAiB;AAChC,UAAI;AACJ,WAAK,IAAI,GAAG,IAAI,IAAI,QAAQ,MAAM,QAAQ,KAAK;AAC7C,YAAI,IAAI,IAAI,QAAQ,MAAM,CAAC;AAC3B,YAAI,IAAI,SAAS,cAAc,GAAG;AAClC,YAAI,OAAO,IAAI,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,GAAG,EAAE,MAAM,mBAAmB,CAAC;AACtE,UAAE,OAAO,IAAI,gBAAgB,IAAI;AACjC,UAAE,WAAW,EAAE;AACf,UAAE,cAAc,cAAc,EAAE;AAChC,YAAI,MAAM,SAAS,cAAc,KAAK;AACtC,YAAI,YAAY,CAAC;AACjB,cAAM,YAAY,GAAG;AAAA,MACvB;AACA,UAAI,eAAe;AACnB;AAAA,IACF;AAEA,QAAI,IAAI,SAAS,oBAAoB;AACnC,0BAAoB,EAAE,aAAa,IAAI,QAAQ,YAAY,CAAC;AAC5D,wBAAkB;AAClB;AAAA,IACF;AAEA,QAAI,IAAI,SAAS,wBAAwB;AACvC,YAAM,cAAc,IAAI,QAAQ;AAChC;AAAA,IACF;AAAA,EACF;AAGA,QAAM,cAAc;AACpB,oBAAkB;AAClB,eAAa,EAAE,MAAM,WAAW,CAAC;",
  "names": []
}
